!function(){"use strict";app=app||{},app.Classroom=Backbone.Model.extend({idAttribute:"_id",defaults:{isLocked:!1},url:function(){return"/classrooms/"+this.model.get("path")+"/configure/"}}),app.Delete=Backbone.Model.extend({idAttribute:"_id",defaults:{success:!1,isLocked:!1,errors:[],errfor:{}},url:function(){return"/classrooms/"+app.mainView.model.get("path")+"/configure/"}}),app.Identity=Backbone.Model.extend({idAttribute:"_id",defaults:{success:!1,errors:[],errfor:{},lesson:"",path:"",PIN:"",name:"",isLocked:!1},url:function(){return"/classrooms/"+app.mainView.model.get("path")+"/configure/"},parse:function(a){return a.user&&(app.mainView.model.set(a.user),delete a.user),a}}),app.HeaderView=Backbone.View.extend({el:"#header",template:_.template($("#tmpl-header").html()),initialize:function(){this.model=app.mainView.model,this.listenTo(this.model,"change",this.render),this.render()},render:function(){this.$el.html(this.template(this.model.attributes))}}),app.IdentityView=Backbone.View.extend({el:"#identity",template:_.template($("#tmpl-identity").html()),events:{"click .btn-update":"update"},initialize:function(){this.model=new app.Identity,this.syncUp(),this.listenTo(app.mainView.model,"change",this.syncUp),this.listenTo(this.model,"sync",this.render),this.render()},syncUp:function(){this.model.set({_id:app.mainView.model.id,name:app.mainView.model.get("name"),path:app.mainView.model.get("path"),PIN:app.mainView.model.get("PIN"),lesson:app.mainView.model.get("lesson"),isLocked:app.mainView.model.get("isLocked")})},render:function(){this.$el.html(this.template(this.model.attributes));for(var a in this.model.attributes)this.model.attributes.hasOwnProperty(a)&&this.$el.find('[name="'+a+'"]').val(this.model.attributes[a])},update:function(){var a=this.model.get("path");this.model.save({name:this.$el.find('[name="name"]').val(),path:this.$el.find('[name="path"]').val(),PIN:this.$el.find('[name="PIN"]').val(),lesson:this.$el.find('[name="lesson"]').val()},{success:function(b,c){c.success&&a!==b.get("path")&&setTimeout(function(){location.href="/classrooms/"+b.get("path")+"/configure/"},500)}})}}),app.DeleteView=Backbone.View.extend({el:"#delete",template:_.template($("#tmpl-delete").html()),events:{"click .btn-delete":"delete"},initialize:function(){this.model=new app.Delete({_id:app.mainView.model.id,isLocked:app.mainView.model.attributes.isLocked}),this.listenTo(this.model,"sync",this.render),this.render()},render:function(){console.log(this.model.attributes),this.$el.html(this.template(this.model.attributes))},"delete":function(){confirm("Are you sure?")&&this.model.destroy({success:function(a,b){b.success?location.href="/classrooms/":app.deleteView.model.set(b)}})}}),app.MainView=Backbone.View.extend({el:".page .container",initialize:function(){app.mainView=this;var a=$("#data-record").html();this.model=new app.Classroom(JSON.parse(a)),console.log(this.model),app.headerView=new app.HeaderView,app.identityView=new app.IdentityView,app.deleteView=new app.DeleteView}}),$(document).ready(function(){app.mainView=new app.MainView})}();
//# sourceMappingURL=indexSessionSettings.min.js.map