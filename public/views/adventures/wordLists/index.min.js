!function(){"use strict";app=app||{},app.Record=Backbone.Model.extend({idAttribute:"_id",defaults:{_id:void 0,words:"",title:""},url:function(){return"/adventures/edit/"+app.mainView.results._id+"/word-lists/"+(this.isNew()?"":this.id+"/")}}),app.RecordCollection=Backbone.Collection.extend({model:app.Record,url:function(){return"/adventures/edit/"+app.mainView.results._id+"/word-lists/"},parse:function(a){return a.wordLists}}),app.HeaderView=Backbone.View.extend({el:"#header",template:_.template($("#tmpl-header").html()),events:{"submit form":"preventSubmit",'keypress input[type="text"]':"addNewOnEnter","click .btn-add":"addNew"},initialize:function(){this.model=new app.Record,this.listenTo(this.model,"change",this.render),this.render()},render:function(){this.$el.html(this.template(this.model.attributes))},preventSubmit:function(a){a.preventDefault()},addNewOnEnter:function(a){13===a.keyCode&&(a.preventDefault(),this.addNew())},addNew:function(){""===this.$el.find('[name="title"]').val()?alert("Please enter a word list title."):this.model.save({title:this.$el.find('[name="title"]').val()},{success:function(a,b){b.success?(a.id=b.record._id,location.href=a.url()):alert(b.errors.join("\n"))}})}}),app.ResultsView=Backbone.View.extend({el:"#results-table",template:_.template($("#tmpl-results-table").html()),initialize:function(){this.collection=new app.RecordCollection(app.mainView.results.wordLists),this.listenTo(this.collection,"reset",this.render),this.render()},render:function(){this.$el.html(this.template());var a=document.createDocumentFragment();this.collection.each(function(b){var c=new app.ResultsRowView({model:b});a.appendChild(c.render().el)},this),$("#results-rows").append(a),0===this.collection.length&&$("#results-rows").append($("#tmpl-results-empty-row").html())}}),app.ResultsRowView=Backbone.View.extend({tagName:"tr",template:_.template($("#tmpl-results-row").html()),events:{"click .btn-details":"viewDetails","click .btn-danger":"deleteWordList"},viewDetails:function(){location.href=this.model.url()},deleteWordList:function(){confirm("Delete: "+this.model.get("title")+"\nAre you sure?")&&this.model.destroy({success:function(){app.resultsView.collection.fetch({data:"",reset:!0})}})},render:function(){return this.$el.html(this.template(this.model.attributes)),this}}),app.MainView=Backbone.View.extend({el:".page .container",initialize:function(){app.mainView=this,this.results=JSON.parse($("#data-results").html()),console.log(this.results.wordLists),app.headerView=new app.HeaderView,app.resultsView=new app.ResultsView}}),app.Router=Backbone.Router.extend({routes:{"":"default","q/:params":"query"},initialize:function(){app.mainView=new app.MainView},"default":function(){app.firstLoad||app.resultsView.collection.fetch({reset:!0}),app.firstLoad=!1},query:function(a){app.resultsView.collection.fetch({data:a,reset:!0}),app.firstLoad=!1}}),$(document).ready(function(){app.firstLoad=!0,app.router=new app.Router,Backbone.history.start()})}();
//# sourceMappingURL=index.min.js.map