/**
 * @license RequireJS text 2.0.10 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/**
 * bootbox.js v4.2.0
 *
 * http://bootboxjs.com/license.txt
 */

define("apps/config/marionette/region/dialog",["jquery","underscore","marionette","bootstrap"],function(e,t,n){return n.Region.Dialog=n.Region.extend({el:"#dialog-region",constructor:function(){Backbone.Marionette.Region.prototype.constructor.apply(this,arguments),this.on("show",this.showModal,this)},showModal:function(t){console.log("showModal"),e("#dialog-region").show(),e("#mymodal").modal("show"),this.listenTo(t,"dialog:close",function(){console.log("dialog:close"),this.hideModal()})},hideModal:function(){console.log("hideModal"),this.$el.modal("hide"),e("body").removeClass("modal-open"),e(".modal-backdrop").remove(),this.stopListening(),this.close()},closeDialog:function(){e("#dialog-region").hide(),this.stopListening(),this.close(),this.$el.dialog("destroy")}}),n.Region.Dialog}),define("text",["module"],function(e){var t,n,r,i,s,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],u=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,f=typeof location!="undefined"&&location.href,l=f&&location.protocol&&location.protocol.replace(/\:/,""),c=f&&location.hostname,h=f&&(location.port||undefined),p={},d=e.config&&e.config()||{};t={version:"2.0.10",strip:function(e){if(e){e=e.replace(u,"");var t=e.match(a);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:d.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(r){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,d.isBuild&&(p[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}d.isBuild=i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),a=d.useXhr||t.useXhr;if(u.indexOf("empty:")===0){r();return}!f||a(u,l,c,h)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(p.hasOwnProperty(n)){var s=t.jsEscape(p[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(d.env==="node"||!d.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node&&!process.versions["node-webkit"])n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=n.readFileSync(e,"utf8");i.indexOf("ï»¿")===0&&(i=i.substring(1)),t(i)}catch(s){r(s)}};else if(d.env==="xhr"||!d.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);d.onXhr&&d.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r(o)):n(s.responseText),d.onXhrComplete&&d.onXhrComplete(s,e))},s.send(null)};else if(d.env==="rhino"||!d.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),r!==null&&n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(d.env==="xpconnect"||!d.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var n,o,u,a={};s&&(e=e.replace(/\//g,"\\")),u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),o=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),o.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),a),o.close(),n.close(),t(a.value)}catch(f){throw new Error((u&&u.path||"")+": "+f)}};return t}),define("text!apps/elements/show/templates/elementShow_template.html",[],function(){return'<div class="activty-question-title camp-adventure-font text-center"><%= activityTitle %></div> \r\n<div class="row question-display margin-0px">\r\n  <!--    <div class="col-xs-1 col-md-1 col-lg-1">\r\n        <a class="btnNav btnPrevious js-question-previous " title="Previous question"></a>\r\n      </div>\r\n  -->\r\n  <div class="btn-previous-area js-question-previous sync-buttons">\r\n    <a class="btn btn-previous " href="#"><i class="fa fa-chevron-left fa-3x "></i></a>\r\n    <!-- <a class="btnNav btnPrevious js-question-previous " title="Previous question"></a>-->\r\n  </div>\r\n  <div class="col-xs-12 col-md-12 col-lg-12 padding-0px margin-0px frameContent" id="divInsertFrame">\r\n    <% if(!isImage) { %>\r\n    <div class="image" id="imageHolder">\r\n      <div class="trick"></div>\r\n      <img id="imageDoc" src="<%= thumbnail %>">\r\n    </div>\r\n    <iframe scrolling="yes" id="frameDoc" src="<%= resourceUrl %>" frameborder="0" onload="$(\'#imageHolder\').css(\'display\', \'none\');"></iframe>\r\n    <% } else { %>\r\n    <div class="image">\r\n      <div class="trick"></div>\r\n      <img id="imageDoc" src="<%= resourceUrl %>" onload="document.initCanvas()">\r\n      <canvas id="c" height="0px" width="0px" style="border:1px solid #aaa;position:absolute;"></canvas>\r\n      <!--<a href="#" id="buttonWalkthrough" class="btn btn-xs btn-default">Sync Slides</a>-->\r\n    </div>\r\n    <% } %>\r\n  </div>\r\n  <a class="btn btn-close js-question-close sync-buttons" href="#"><i class="fa fa-times fa-3x"></i></a>\r\n  <div class="btn-next-area js-question-next sync-buttons">\r\n    <!--  <a class="btnNav btnCloseElement js-question-close" id="clear-selected" title="Close"></a>-->        \r\n    <a class="btn btn-next " href="#"><i class="fa fa-chevron-right fa-3x "></i></a>\r\n    <!-- <a class="btnNav btnNext  js-question-next" title="Next question"></a>-->\r\n  </div>\r\n  <!--\r\n      <div class="col-xs-1 col-md-1 col-lg-1">\r\n        <a class="btnNav btnCloseElement js-question-close" id="clear-selected" title="Close"></a>\r\n      </div> \r\n      <div class="col-xs-1 col-md-1 col-lg-1">\r\n        <a class="btnNav btnNext  js-question-next" title="Next question"></a>\r\n      </div>    \r\n  -->\r\n</div>\r\n<div class="row  margin-0px question-text-area">\r\n  <div class="question-text-input col-lg-12 col-md-12 col-sm-12 col-xs-12 padding-0px">\r\n    <div class="number-question  col-lg-1 col-md-1 col-sm-1 col-xs-2 padding-0px">\r\n      <!--        <span  class="question-label">Question : </span>-->\r\n      <span class="btn-circle-question btn-number"><%= index %></span>\r\n    </div>\r\n    <div class=" col-lg-10 col-md-10 col-sm-10 col-xs-9 question-text js-question-text padding-0px" id="question-text">\r\n      <div class="vcenter"><%= questionText %></div>\r\n    </div>\r\n  </div>\r\n</div>\r\n<div class=\'answer-area\'></div>\r\n\r\n\r\n'}),define("apps/elements/show/elementsShow_view",["app","text!apps/elements/show/templates/elementShow_template.html"],function(e,t){return e.module("ElementsApp.Show.View",function(e,n,r,i,s,o){e.Element=i.Layout.extend({template:o.template(t),regions:{answerArea:".answer-area"},className:"container-fluid padding-0px grey",events:{"click .js-question-next":"questionNextClicked","click .js-question-previous":"questionPreviousClicked","click .js-question-close":"questionCloseClicked"},questionNextClicked:function(e){e.preventDefault(),this.trigger("element:question:next",e.target,this.model)},questionPreviousClicked:function(e){e.preventDefault(),this.trigger("element:question:previous",e.target,this.model)},questionCloseClicked:function(e){e.preventDefault(),this.trigger("element:question:close",this.model)},initialize:function(){}})}),e.ElementsApp.Show.View}),define("server/sync",["app"],function(e){return e.module("Server",function(e,t,n,r,i,s){var o="ACTIVITY";e.Sync={MessageToServerStudentAnswer:function(e){window.pluginToServer(o,"StudentAnswer",{answer:e})}}}),e.Server.Sync}),!function(e,t){"function"==typeof define&&define.amd?define("bootbox",["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):e.bootbox=t(e.jQuery)}(this,function e(t,n){function r(e){var t=m[d.locale];return t?t[e]:m.en[e]}function i(e,n,r){e.stopPropagation(),e.preventDefault();var i=t.isFunction(r)&&r(e)===!1;i||n.modal("hide")}function s(e){var t,n=0;for(t in e)n++;return n}function o(e,n){var r=0;t.each(e,function(e,t){n(e,t,r++)})}function u(e){var n,r;if("object"!=typeof e)throw new Error("Please supply an object of options");if(!e.message)throw new Error("Please specify a message");return e=t.extend({},d,e),e.buttons||(e.buttons={}),e.backdrop=e.backdrop?"static":!1,n=e.buttons,r=s(n),o(n,function(e,i,s){if(t.isFunction(i)&&(i=n[e]={callback:i}),"object"!==t.type(i))throw new Error("button with key "+e+" must be an object");i.label||(i.label=e),i.className||(i.className=2>=r&&s===r-1?"btn-primary":"btn-default")}),e}function a(e,t){var n=e.length,r={};if(1>n||n>2)throw new Error("Invalid argument length");return 2===n||"string"==typeof e[0]?(r[t[0]]=e[0],r[t[1]]=e[1]):r=e[0],r}function f(e,n,r){return t.extend(!0,{},e,a(n,r))}function l(e,t,n,r){var i={className:"bootbox-"+e,buttons:c.apply(null,t)};return h(f(i,r,n),t)}function c(){for(var e={},t=0,n=arguments.length;n>t;t++){var i=arguments[t],s=i.toLowerCase(),o=i.toUpperCase();e[s]={label:r(o)}}return e}function h(e,t){var r={};return o(t,function(e,t){r[t]=!0}),o(e.buttons,function(e){if(r[e]===n)throw new Error("button key "+e+" is not allowed (options are "+t.join("\n")+")")}),e}var p={dialog:"<div class='bootbox modal' tabindex='-1' role='dialog'><div class='modal-dialog'><div class='modal-content'><div class='modal-body'><div class='bootbox-body'></div></div></div></div></div>",header:"<div class='modal-header'><h4 class='modal-title'></h4></div>",footer:"<div class='modal-footer'></div>",closeButton:"<button type='button' class='bootbox-close-button close' data-dismiss='modal' aria-hidden='true'>&times;</button>",form:"<form class='bootbox-form'></form>",inputs:{text:"<input class='bootbox-input bootbox-input-text form-control' autocomplete=off type=text />",textarea:"<textarea class='bootbox-input bootbox-input-textarea form-control'></textarea>",email:"<input class='bootbox-input bootbox-input-email form-control' autocomplete='off' type='email' />",select:"<select class='bootbox-input bootbox-input-select form-control'></select>",checkbox:"<div class='checkbox'><label><input class='bootbox-input bootbox-input-checkbox' type='checkbox' /></label></div>",date:"<input class='bootbox-input bootbox-input-date form-control' autocomplete=off type='date' />",time:"<input class='bootbox-input bootbox-input-time form-control' autocomplete=off type='time' />",number:"<input class='bootbox-input bootbox-input-number form-control' autocomplete=off type='number' />",password:"<input class='bootbox-input bootbox-input-password form-control' autocomplete='off' type='password' />"}},d={locale:"en",backdrop:!0,animate:!0,className:null,closeButton:!0,show:!0,container:"body"},v={};v.alert=function(){var e;if(e=l("alert",["ok"],["message","callback"],arguments),e.callback&&!t.isFunction(e.callback))throw new Error("alert requires callback property to be a function when provided");return e.buttons.ok.callback=e.onEscape=function(){return t.isFunction(e.callback)?e.callback():!0},v.dialog(e)},v.confirm=function(){var e;if(e=l("confirm",["cancel","confirm"],["message","callback"],arguments),e.buttons.cancel.callback=e.onEscape=function(){return e.callback(!1)},e.buttons.confirm.callback=function(){return e.callback(!0)},!t.isFunction(e.callback))throw new Error("confirm requires a callback");return v.dialog(e)},v.prompt=function(){var e,r,i,s,u,a,l;s=t(p.form),r={className:"bootbox-prompt",buttons:c("cancel","confirm"),value:"",inputType:"text"},e=h(f(r,arguments,["title","callback"]),["cancel","confirm"]),a=e.show===n?!0:e.show;var d=["date","time","number"],m=document.createElement("input");if(m.setAttribute("type",e.inputType),d[e.inputType]&&(e.inputType=m.type),e.message=s,e.buttons.cancel.callback=e.onEscape=function(){return e.callback(null)},e.buttons.confirm.callback=function(){var n;switch(e.inputType){case"text":case"textarea":case"email":case"select":case"date":case"time":case"number":case"password":n=u.val();break;case"checkbox":var r=u.find("input:checked");n=[],o(r,function(e,r){n.push(t(r).val())})}return e.callback(n)},e.show=!1,!e.title)throw new Error("prompt requires a title");if(!t.isFunction(e.callback))throw new Error("prompt requires a callback");if(!p.inputs[e.inputType])throw new Error("invalid prompt type");switch(u=t(p.inputs[e.inputType]),e.inputType){case"text":case"textarea":case"email":case"date":case"time":case"number":case"password":u.val(e.value);break;case"select":var y={};if(l=e.inputOptions||[],!l.length)throw new Error("prompt with select requires options");o(l,function(e,r){var i=u;if(r.value===n||r.text===n)throw new Error("given options in wrong format");r.group&&(y[r.group]||(y[r.group]=t("<optgroup/>").attr("label",r.group)),i=y[r.group]),i.append("<option value='"+r.value+"'>"+r.text+"</option>")}),o(y,function(e,t){u.append(t)}),u.val(e.value);break;case"checkbox":var w=t.isArray(e.value)?e.value:[e.value];if(l=e.inputOptions||[],!l.length)throw new Error("prompt with checkbox requires options");if(!l[0].value||!l[0].text)throw new Error("given options in wrong format");u=t("<div/>"),o(l,function(n,r){var i=t(p.inputs[e.inputType]);i.find("input").attr("value",r.value),i.find("label").append(r.text),o(w,function(e,t){t===r.value&&i.find("input").prop("checked",!0)}),u.append(i)})}return e.placeholder&&u.attr("placeholder",e.placeholder),e.pattern&&u.attr("pattern",e.pattern),s.append(u),s.on("submit",function(e){e.preventDefault(),i.find(".btn-primary").click()}),i=v.dialog(e),i.off("shown.bs.modal"),i.on("shown.bs.modal",function(){u.focus(),u.select()}),a===!0&&i.modal("show"),i},v.dialog=function(e){e=u(e);var n=t(p.dialog),r=n.find(".modal-body"),s=e.buttons,a="",f={onEscape:e.onEscape};if(o(s,function(e,t){a+="<button data-bb-handler='"+e+"' type='button' class='btn "+t.className+"'>"+t.label+"</button>",f[e]=t.callback}),r.find(".bootbox-body").html(e.message),e.animate===!0&&n.addClass("fade"),e.className&&n.addClass(e.className),e.title&&r.before(p.header),e.closeButton){var l=t(p.closeButton);e.title?n.find(".modal-header").prepend(l):l.css("margin-top","-10px").prependTo(r)}return e.title&&n.find(".modal-title").html(e.title),a.length&&(r.after(p.footer),n.find(".modal-footer").html(a)),n.on("hidden.bs.modal",function(e){e.target===this&&n.remove()}),n.on("shown.bs.modal",function(){n.find(".btn-primary:first").focus()}),n.on("escape.close.bb",function(e){f.onEscape&&i(e,n,f.onEscape)}),n.on("click",".modal-footer button",function(e){var r=t(this).data("bb-handler");i(e,n,f[r])}),n.on("click",".bootbox-close-button",function(e){i(e,n,f.onEscape)}),n.on("keyup",function(e){27===e.which&&n.trigger("escape.close.bb")}),t(e.container).append(n),n.modal({backdrop:e.backdrop,keyboard:!1,show:!1}),e.show&&n.modal("show"),n},v.setDefaults=function(){var e={};2===arguments.length?e[arguments[0]]=arguments[1]:e=arguments[0],t.extend(d,e)},v.hideAll=function(){t(".bootbox").modal("hide")};var m={br:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Sim"},da:{OK:"OK",CANCEL:"Annuller",CONFIRM:"Accepter"},de:{OK:"OK",CANCEL:"Abbrechen",CONFIRM:"Akzeptieren"},en:{OK:"OK",CANCEL:"Cancel",CONFIRM:"OK"},es:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Aceptar"},fi:{OK:"OK",CANCEL:"Peruuta",CONFIRM:"OK"},fr:{OK:"OK",CANCEL:"Annuler",CONFIRM:"D'accord"},he:{OK:"×××©××¨",CANCEL:"×××××",CONFIRM:"×××©××¨"},it:{OK:"OK",CANCEL:"Annulla",CONFIRM:"Conferma"},lt:{OK:"Gerai",CANCEL:"AtÅ¡aukti",CONFIRM:"Patvirtinti"},lv:{OK:"Labi",CANCEL:"Atcelt",CONFIRM:"ApstiprinÄt"},nl:{OK:"OK",CANCEL:"Annuleren",CONFIRM:"Accepteren"},no:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},pl:{OK:"OK",CANCEL:"Anuluj",CONFIRM:"PotwierdÅº"},ru:{OK:"OK",CANCEL:"ÐÑÐ¼ÐµÐ½Ð°",CONFIRM:"ÐÑÐ¸Ð¼ÐµÐ½Ð¸ÑÑ"},sv:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},tr:{OK:"Tamam",CANCEL:"Ä°ptal",CONFIRM:"Onayla"},zh_CN:{OK:"OK",CANCEL:"åæ¶",CONFIRM:"ç¡®è®¤"},zh_TW:{OK:"OK",CANCEL:"åæ¶",CONFIRM:"ç¢ºèª"}};return v.init=function(n){return e(n||t)},v}),function(e,t){typeof define=="function"&&define.amd?define("grids",["jquery"],t):typeof exports=="object"&&(module.exports=t(require("jquery")))}(this,function(t,n){t.fn.equalHeight=function(){var e=[];return t.each(this,function(n,r){$element=t(r);var i,s=$element.css("box-sizing")=="border-box"||$element.css("-moz-box-sizing")=="border-box";s?i=$element.innerHeight():i=$element.height(),e.push(i)}),this.height(Math.max.apply(window,e)),this},t.fn.equalHeightGrid=function(e){var n=this;n.css("height","auto");for(var r=0;r<n.length;r++)if(r%e===0){var i=t(n[r]);for(var s=1;s<e;s++)i=i.add(n[r+s]);i.equalHeight()}return this},t.fn.detectGridColumns=function(){var e=0,n=0;return this.each(function(r,i){var s=t(i).offset().top;if(e!==0&&s!=e)return!1;n++,e=s}),n},t.fn.responsiveEqualHeightGrid=function(){function n(){var t=e.detectGridColumns();e.equalHeightGrid(t)}var e=this;return t(window).bind("resize load",n),n(),this}}),define("entities/element/element_model",["jquery","underscore","backbone","app"],function(e,t,n,r){var i=n.Model.extend({idAttribute:"_id",defaults:{_id:"",answer:"",textAnswer:"",gotAnswer:!1,questionText:"",resourceUrl:"about:blank",thumbnail:"about:blank",isImage:!1,answerTextA:"",answerTextB:"",answerTextC:"",answerTextD:"",responseType:"mul"}}),s={getElementEntity:function(t){var n=new Activity({id:t}),r=e.Deferred();return n.fetch({success:function(e){r.resolve(e)},error:function(e){r.resolve(undefined)}}),r.promise()}};return r.reqres.setHandler("element:entity",function(e){return s.getElementEntity(e)}),r.reqres.setHandler("element:entity:new",function(e){return new i}),i}),define("entities/element/element_collection",["jquery","underscore","backbone","app","entities/element/element_model"],function(e,t,n,r,i){var s=n.Collection.extend({model:i}),o=function(){var t=JSON.parse(e("#data-results").html()),n=t._id,r=new ActivityCollection(t.activities,n);return r},u=function(){var e=[{resourceUrl:"../../plugins/randomizer/randomizer.html",gotAnswer:"true",questionText:"Test Question 1",answer:"a",answerTextA:"Question 1 Text for Answer A",answerTextB:"Question 1 Text for Answer B",answerTextC:"Question 1 Text for Answer C",answerTextD:"Question 1 Text for Answer D"},{resourceUrl:"../../plugins/airweb/index_b.html",gotAnswer:"true",questionText:"Test Question 2",answer:"b",answerTextA:"Question 2 Text for Answer A",answerTextB:"Question 2 Text for Answer B",answerTextC:"Question 2 Text for Answer C",answerTextD:"Question 2 Text for Answer D"},{resourceUrl:"https://docs.google.com/document/d/1HeNsERfR37ulbmshKaxvhWzkZFvoMIv5vB02YikswuQ/preview",gotAnswer:"true",questionText:"Test Question 3",answer:"c",answerTextA:"Question 3 Text for Answer A",answerTextB:"Question 3 Text for Answer B",answerTextC:"Question 3 Text for Answer C",answerTextD:"Question 3 Text for Answer D"},{resourceUrl:"https://docs.google.com/document/d/1HeNsERfR37ulbmshKaxvhWzkZFvoMIv5vB02YikswuQ/preview",gotAnswer:"true",questionText:"Test Question 4",answer:"d",answerTextA:"Question 4 Text for Answer A",answerTextB:"Question 4 Text for Answer B",answerTextC:"Question 4 Text for Answer C",answerTextD:"Question 4 Text for Answer D"},{resourceUrl:"https://docs.google.com/document/d/1HeNsERfR37ulbmshKaxvhWzkZFvoMIv5vB02YikswuQ/preview",gotAnswer:"false",questionText:"Test Question 5",answer:""}],t=JSON.parse(JSON.stringify(e));return new s(t)},a=function(){var e=new i({gotAnswer:"false",questionText:"Test Question 1"}),t=new i({gotAnswer:"false",questionText:"Test Question 2"}),n=new i({gotAnswer:"false",questionText:"Test Question 3"});return new s([e,t,n])};return API={getElementEntities:function(){},getElementEntititesFromHTML:function(){return u()}},r.reqres.setHandler("element:entities",function(){return API.getElementEntities()}),r.reqres.setHandler("element:entities:initialize",function(){return API.getElementEntititesFromHTML()}),s}),define("entities/activity/activity_model",["jquery","underscore","backbone","app","entities/element/element_collection"],function(e,t,n,r,i){Activity=n.Model.extend({idAttribute:"_id",url:function(){return t.result(this.collection,"url")+(this.isNew()?"":this.id+"/")},model:{elements:i},parse:function(e){this.set("_id",e._id);for(var t in this.model){var n=this.model[t],r=e[t];e[t]=new n(r)}return e},defaults:{thumbnail:"activityModel.jpg",desc:"Activity Description",activityType:"game",colorTag:"dullPink",selected:!1,elements:"",index:"",tileType:"checkpoint",x:"0",y:"0",active:!0,first:!1,icon:"fa-university",wordLists:[],pluginApp:"",pluginAppIcon:""},initialize:function(e){if(e&&!(e.elements instanceof n.Collection)){var t=this.model.elements,r=e.elements;e.elements=new t(r),this.set("elements",e.elements),this.set("activityName","test")}},toggleSelected:function(){this.set({selected:!this.get("selected")})},clear:function(){console.log("destroy"),this.destroy()}});var s={getActivityEntity:function(t){var n=new Activity({id:t}),r=e.Deferred();return n.fetch({success:function(e){r.resolve(e)},error:function(e){r.resolve(undefined)}}),r.promise()}};return r.reqres.setHandler("activity:entity",function(e){return s.getActivityEntity(e)}),r.reqres.setHandler("activity:entity:new",function(e){return new Activity}),Activity}),define("entities/activity/activity_collection",["jquery","underscore","backbone","app","entities/activity/activity_model"],function(e,t,n,r,i){function l(e){t.each(e.models,function(e){var n=e.collection.indexOf(e)+1;e.set("index",n);var r=e.get("elements");if(r.length!==0){var i=e.get("elements");t.each(i.models,function(e){var t=e.collection.indexOf(e)+1;e.set("index",n+"."+t),e.get("_id")===""&&e.set("_id",t)})}},this)}function c(e){jq(window.document).off("ServerToPluginACTIVITY"),jq(window.document).on("ServerToPluginACTIVITY",function(n,r){var i=r.detail;switch(i.pluginMessageType){case"GetStudentAnswersResponse":var s=i.data.activities;t.each(e.models,function(e){if(s[e.id]){var n=e.get("elements");t.each(n.models,function(t){if(s[e.id][t.cid]){var n=s[e.id][t.cid].studentAnswer;t.set("studentAnswered",n.answerSubmitted)}})}})}}),window.pluginToServer("ACTIVITY","GetStudentAnswers",{})}ActivityCollection=n.Collection.extend({model:i,url:function(){return"/"+this.pathSession},parse:function(e){return e.activities},initialize:function(e,t){this.pathSession=t},selected:function(){return this.filter(function(e){return e.get("selected")})},remaining:function(){return this.without.apply(this,this.selected())}});var s=JSON.parse(e("#data-session").html()),o=s.idSession,u=s.path,a=function(){var e=new ActivityCollection(s.activities,u);return l(e),e},f={getActivityEntities:function(t){var n={},r=new ActivityCollection(n,u),i=e.Deferred();return r.fetch({success:function(e){l(e),i.resolve(e)},error:function(e){i.resolve(e)}}),i.promise()},getActivityEntitiesFromHTML:function(){var e=a();return l(e),c(e),e}};return r.reqres.setHandler("activity:entities",function(){return f.getActivityEntities()}),r.reqres.setHandler("activity:entities:initialized",function(){return f.getActivityEntitiesFromHTML()}),ActivityCollection}),define("apps/elements/show/elementsShow_controller",["app","apps/elements/show/elementsShow_view","server/sync","bootbox","mathjax","grids"],function(e,t,n,r,i){return e.module("ElementsApp.Show",function(e,n,r,i,s,o){function f(){var e=n.request("model"),t=n.request("activity"),r=e.collection.indexOf(e),i=r+1;if(!e.collection.at(i))return;n.navigate("/adventures/"+t.id+"/elements/"+(i+1)),c.showElementView(t,e.collection.at(i))}function l(){var e=n.request("model"),t=n.request("activity"),r=e.collection.indexOf(e),i=r-1;if(i<0)return;n.navigate("/adventures/"+t.id+"/elements/"+(i+1)),c.showElementView(t,e.collection.at(i))}var u=i.Controller.extend({showElement:function(e,t){require(["entities/activity/activity_collection"],function(){var r=n.request("activity:entities:initialized");s.when(r).done(function(r){var i=r.get(e);if(typeof i=="undefined")n.navigate("",{trigger:!0});else{var s=i.get("elements").at(t-1);c.showElementView(i,s)}})})},showFirstElement:function(e){var t=0,n=e.get("elements");if(n.length===0){alert("There is no elements to be shown");return}var r=n.at(t);c.showElementView(e,r)}});e.Controller=new u;var a=e.Controller,c={showElementView:function(e,r){n.reqres.setHandler("activity",function(){return e}),n.reqres.setHandler("model",function(){return r}),n.commands.setHandler("next",function(){f()}),n.commands.setHandler("prev",function(){l()}),typeof r=="undefined"&&n.navigate("",{trigger:!0});var i="";r.set("activityTitle",e.get("activityTitle"));var o=new t.Element({model:r}),u=r.collection.indexOf(r);a.listenTo(o,"show",function(){s("#main-region").scrollTop(0),n.reqres.setHandler("element:answerArea",function(){return o.answerArea}),n.reqres.setHandler("activity",function(){return e}),r.get("responseType")!==""&&n.trigger("responses:show",r),u===0&&s(".btn-previous").hide();var t=u+1;r.collection.at(t)||s(".btn-next").hide(),r.get("resourceUrl")==="about:blank"&&(s(".question-text").addClass("noMedia"),s("#divInsertFrame").hide()),r.get("questionText")===""&&s(".question-text-area").hide()}),a.listenTo(o,"element:question:previous",function(e,t){l()}),a.listenTo(o,"element:question:next",function(e,t){f()}),a.listenTo(o,"element:question:close",function(e){var t=n.getCurrentRoute().split("/")[1],r;r={activityIDToBeAnimated:t},n.trigger("activities:listActivities:initialized",r),n.navigate("")}),n.mainRegion.show(o)}};API={MessageToServerStudentAnswer:function(e){var t={type:"StudentAnswer",value:e};jq(document).trigger("studentToServer",{detail:t})}}}),e.ElementsApp.Show.Controller}),define("apps/elements/elements_app",["app"],function(e){e.module("Router.ElementsApp",function(e,t,n,r,i,s){e.Router=r.AppRouter.extend({appRoutes:{"adventures/:id":"showFirstElement","adventures/:id/elements/:id":"showElement"}});var o={showFirstElement:function(e){require(["apps/elements/show/elementsShow_controller"],function(t){t.showFirstElement(e)})},showElement:function(e,t){require(["apps/elements/show/elementsShow_controller"],function(n){n.showElement(e,t)})}};t.on("element:show",function(e){t.navigate("#adventures/"+e.id+"/elements/1"),o.showFirstElement(e)}),t.addInitializer(function(){new e.Router({controller:o})})})}),define("text!apps/activities/listActivities/templates/activity_item.html",[],function(){return'<% if (tileType === "checkpoint") { %>\n<div class="activity-checkpoint ">\n  <% if (activityType ==="media" && elements.length ===0  ) { %>\n  <% console.log("this actitvity", elements.length) %>\n  <div class="checkpoint-wrapper js-move">\n    <div class="checkpoint markerBlue ">\n      <!--      <img class="checkpoint-img checkpoint-shadow">-->\n    </div>\n    <div class="checkpoint-desc">?</div>\n  </div>  \n  <% } else if (activityType ==="media" && elements.length !== 0 && checkPointIcon === "" ) { %>\n  <div class="checkpoint-wrapper js-move ">\n    <div class="checkpoint markerBlue">\n      <!--      <img class="checkpoint-img " src="/webapp/images/checkpoint_blue.svg">-->\n    </div>\n    <div class="checkpoint-desc">Q</div>\n  </div>\n  <% } else if (activityType ==="media" && elements.length !== 0 && checkPointIcon !== "" ) { %>\n  <div class="checkpoint-wrapper js-move ">\n    <div class="checkpoint  <%= checkPointIcon %>">\n      <!--      <img class="checkpoint-img " src="/webapp/images/checkpoint_blue.svg">-->\n    </div>\n    <div class="checkpoint-desc">Q</div>\n  </div>  \n  <% } else if (activityType ==="wordList" && pluginApp === "" ){  %>\n  <div class="checkpoint-wrapper js-move">    \n    <div class="checkpoint markerBrown"></div>\n    <div class="checkpoint-desc">W</div>\n  </div>  \n  <% } else if (activityType ==="wordList" && checkPointIcon === ""){  %>\n  <div class="checkpoint-wrapper js-move">   \n    <div class="checkpoint markerBrown"></div>         \n    <div class="checkpoint-desc "> <i class="fa <%= pluginAppIcon %>"></i> </div>  \n  </div>\n  <% } else if (activityType ==="wordList" && checkPointIcon !== ""){  %>\n  <div class="checkpoint-wrapper js-move">   \n    <div class="checkpoint <%= checkPointIcon %>"></div>         \n    <div class="checkpoint-desc "> <i class="fa <%= pluginAppIcon %>"></i> </div>  \n  </div>  \n  <% } else { %>\n  <div class="checkpoint-wrapper js-move">    \n    <div class="checkpoint markerBlue "></div>\n    <div class="checkpoint-desc"></div>\n  </div>  \n  <% }  %>\n  <div class="activity-coordinate" data-x="<%= x  %>" data-y="<%= y %>" ></div>\n\n  <% if( activityTitle !== "Edit Title") {%>\n  <div class="activity-description ">\n    <span class="activity-activity-desc js-move"><%= activityTitle %></span>\n  </div>\n  <% }%>\n</div>\n<% }  %>\n'}),define("text!apps/activities/listActivities/templates/activity_map.html",[],function(){return'<div class="row activity-title">\n  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">\n     <span><%= lessonName %>  </span>  \n  </div>\n \n</div>\n<p></p>\n\n<div id="adventure-view" class="row" style="background-image:url(\'<%= backgroundImageURL %>\')"></div>\n<% if (window.top !== window.self) { %>\n<div class="test-view-text text-center">Mock Student</div>\n<% } else if  (window.isPreview) { %>\n<div class="test-view-text text-center">Preview</div>  \n<% } %>\n'}),define("text!apps/activities/listActivities/templates/activity_tile.html",[],function(){return'<% if ( a === true ) { %>\n  <% if (tileType === "linkhor") { %>\n  <div class="activity-direction">\n    <div class="activity-coordinate" data-x="<%= x  %>" data-y="<%= y %>" ></div>\n    <!--<span><i class="fa fa-minus fa-3x"></i></span>-->\n    <% if ( a !== true ) { %>\n    <div class="horizontal-line js-toggle-hor tile-non-active" />\n    <% } else { %>\n    <div class="horizontal-line js-toggle-hor" />\n    <% } %>\n  </div>\n  <% } else if (tileType === "linkver") {  %>\n\n  <div class="activity-direction ">\n\n    <div class="activity-coordinate" data-x="<%= x  %>" data-y="<%= y %>" >\n      <!--    <span class="vertical-link"> | </span>-->\n    </div>\n    <% if ( a !== true ) { %>\n    <div class="vertical-line js-toggle-ver tile-non-active" />\n    <% } else { %>\n    <div class="vertical-line js-toggle-ver" />\n    <% } %>\n  </div>\n  <% } else if (tileType === "dropzone") { %>\n  <div class="activity-dropzone dropzone js-new">\n    <div class="activity-coordinate" data-x="<%= x  %>" data-y="<%= y %>" >\n      <!--    <span class="vertical-link"> | </span>-->\n    </div>\n\n  </div>\n  <% } %>\n<% } %>\n'}),!function(e){function t(){}function n(e){return!!e&&("object"==typeof Element?e instanceof Element:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName)}function r(e,t){o(t,gt),e.pageX=gt.x,e.pageY=gt.y,u(t,gt),e.clientX=gt.x,e.clientY=gt.y,e.timeStamp=(new Date).getTime()}function i(e,t,n){e.pageX=n.pageX-t.pageX,e.pageY=n.pageY-t.pageY,e.clientX=n.clientX-t.clientX,e.clientY=n.clientY-t.clientY,e.timeStamp=(new Date).getTime()-t.timeStamp;var r=Math.max(e.timeStamp/1e3,.001);e.pageSpeed=st(e.pageX,e.pageY)/r,e.pageVX=e.pageX/r,e.pageVY=e.pageY/r,e.clientSpeed=st(e.clientX,e.pageY)/r,e.clientVX=e.clientX/r,e.clientVY=e.clientY/r}function s(e,t,n){var r,i,s;return n=n||{},e=e||"page",/touch/.test(t.type)&&t.touches?(r=t.touches.length?t.touches[0]:t.changedTouches[0],i=r[e+"X"],s=r[e+"Y"]):(i=t[e+"X"],s=t[e+"Y"]),n.x=i,n.y=s,n}function o(t,n){return n=n||{},t instanceof S?/inertiastart/.test(t.type)?(o(yt.pointerUp,n),n.x+=yt.sx,n.y+=yt.sy):(n.x=t.pageX,n.y=t.pageY):Zt?(s("screen",t,n),n.x+=e.scrollX,n.y+=e.scrollY):/gesture|inertia/i.test(t.type)?(s("client",t,n),n.x+=Q.documentElement.scrollLeft,n.y+=Q.documentElement.scrollTop):s("page",t,n),n}function u(e,t){return t=t||{},e instanceof S?/inertiastart/.test(e.type)?(u(yt.pointerUp,t),t.x+=yt.sx,t.y+=yt.sy):(t.x=e.clientX,t.y=e.clientY):s(Zt?"screen":"client",e,t),t}function a(){return{x:e.scrollX||Q.documentElement.scrollLeft,y:e.scrollY||Q.documentElement.scrollTop}}function f(e){var t=/ipad|iphone|ipod/i.test(navigator.userAgent)?{x:0,y:0}:a(),n=e instanceof Y?e.getBoundingClientRect():e.getClientRects()[0];return n&&{left:n.left+t.x,right:n.right+t.x,top:n.top+t.y,bottom:n.bottom+t.y,width:n.width||n.right-n.left,height:n.heigh||n.bottom-n.top}}function l(e){var t=[];return e instanceof Array?(t[0]=e[0],t[1]=e[1]):rt?(t[0]=ct[0],t[1]=ct[1]):(t[0]=e.touches[0],t[1]="touchend"===e.type&&1===e.touches.length?e.changedTouches[0]:e.touches[1]),t}function c(e){var t=l(e);return{pageX:(t[0].pageX+t[1].pageX)/2,pageY:(t[0].pageY+t[1].pageY)/2,clientX:(t[0].clientX+t[1].clientX)/2,clientY:(t[0].clientY+t[1].clientY)/2}}function h(e){if(e.touches&&e.touches.length||rt&&ct.length){var t=l(e),n=Math.min(t[0].pageX,t[1].pageX),r=Math.min(t[0].pageY,t[1].pageY),i=Math.max(t[0].pageX,t[1].pageX),s=Math.max(t[0].pageY,t[1].pageY);return{x:n,y:r,left:n,top:r,width:i-n,height:s-r}}}function p(e){var t=(Lt&&Lt.options||Dt).deltaSource,n=t+"X",r=t+"Y",i=l(e),s=i[0][n]-i[1][n],o=i[0][r]-i[1][r];return st(s,o)}function d(e,t){var n=(Lt&&Lt.options||Dt).deltaSource,r=n+"X",i=n+"Y",s=l(e),o=s[0][r]-s[1][r],u=s[0][i]-s[1][i],a=180*Math.atan(u/o)/Math.PI;if("number"==typeof t){var f=a-t,c=f%360;c>315?a-=360+a/360|0:c>135?a-=180+a/360|0:-315>c?a+=360+a/360|0:-135>c&&(a+=180+a/360|0)}return a}function v(e,t){e=e||Lt;var r=e?e.options.origin:Dt.origin;return t=t||e._element,"parent"===r?r=t.parentNode:"self"===r&&(r=t),n(r)?(r=f(r),r.x=r.left,r.y=r.top):"function"==typeof r&&(r=r(e&&t)),r}function m(e){for(var t=0,n=e.length;n>t;t++)e[t].rect=e[t].getRect()}function g(){var e=yt.target.options.inertia,t=e.resistance,n=(new Date).getTime()/1e3-yt.t0;if(n<yt.te){var r=1-(Math.exp(-t*n)-yt.lambda_v0)/yt.one_ve_v0;if(yt.modifiedXe===yt.xe&&yt.modifiedYe===yt.ye)yt.sx=yt.xe*r,yt.sy=yt.ye*r;else{var i=b(0,0,yt.xe,yt.ye,yt.modifiedXe,yt.modifiedYe,r);yt.sx=i.x,yt.sy=i.y}M(yt.startEvent),yt.i=tn(g)}else yt.sx=yt.modifiedXe,yt.sy=yt.modifiedYe,yt.active=!1,M(yt.startEvent),U(yt.startEvent)}function y(e,t,n,r){var i=1-e;return i*i*t+2*i*e*n+e*e*r}function b(e,t,n,r,i,s,o){return{x:y(o,e,n,i),y:y(o,t,r,s)}}function w(e){if(e.length){var t,n,r,i,s,o=e[0],u=[],a=[];for(i=1;i<e.length;i++){if(t=e[i],!u.length)for(n=o;n.parentNode!==Q;)u.unshift(n),n=n.parentNode;if(o instanceof tt&&t instanceof Y&&!(t instanceof Z)){if(t===o.parentNode)continue;n=t.ownerSVGElement}else n=t;for(a=[];n.parentNode!==Q;)a.unshift(n),n=n.parentNode;for(s=0;a[s]&&a[s]===u[s];)s++;var f=[a[s-1],a[s],u[s]];for(r=f[0].lastChild;r;){if(r===f[1]){o=t,u=[];break}if(r===f[2])break;r=r.previousSibling}}return{element:o,index:e.indexOf(o)}}}function E(e,t){if(Et.length||Tt.length){var r,i,s,o=[],u=[],a=[],f=[];for(t=t||Lt._element,r=0;r<Et.length;r++){var l=Et[r];if(n(l.options.accept)){if(l.options.accept!==t)continue}else if("string"==typeof l.options.accept&&!t[en](l.options.accept))continue;t!==l._element&&l.dropCheck(e,Lt,t)&&(o.push(l),u.push(l._element))}if(i=w(u),s=i?o[i.index]:null,Tt.length){for(r=0;r<Tt.length;r++)for(var c=Tt[r],h=Q.querySelectorAll(c.selector),p=0,d=h.length;d>p;p++){if(c._element=h[p],c.rect=c.getRect(),n(c.options.accept)){if(c.options.accept!==t)continue}else if("string"==typeof c.options.accept&&!t[en](c.options.accept))continue;c._element!==t&&-1===u.indexOf(c._element)&&f.indexOf(-1===c._element)&&c.dropCheck(e,Lt)&&(a.push(c),f.push(c._element))}f.length&&(s&&(a.push(s),f.push(s._element)),i=w(f),i&&(s=a[i.index],s.selector&&(s._element=f[i.index])))}return s?{dropzone:s,element:s._element}:null}}function S(e,t,n,i,s){var a,f,l=(Lt&&Lt.options||Dt).deltaSource,m=l+"X",g=l+"Y",y=Lt?Lt.options:Dt,b=v(Lt,i);if(i=i||Lt._element,"gesture"===t){var w=c(e);f={x:w.pageX-b.x,y:w.pageY-b.y},a={x:w.clientX-b.x,y:w.clientY-b.y}}else f=o(e),a=u(e),f.x-=b.x,f.y-=b.y,a.x-=b.x,a.y-=b.y,y.snapEnabled&&-1!==y.snap.actions.indexOf(t)&&(this.snap={range:Pt.range,locked:Pt.locked,x:Pt.x,y:Pt.y,realX:Pt.realX,realY:Pt.realY,dx:Pt.dx,dy:Pt.dy},Pt.locked&&(f.x+=Pt.dx,f.y+=Pt.dy,a.x+=Pt.dx,a.y+=Pt.dy));if(Lt.options.restrict[t]&&Ht.restricted&&(f.x+=Ht.dx,f.y+=Ht.dy,a.x+=Ht.dx,a.y+=Ht.dy,this.restrict={dx:Ht.dx,dy:Ht.dy}),this.pageX=f.x,this.pageY=f.y,this.clientX=a.x,this.clientY=a.y,"start"!==n||e instanceof S||r(at,this),this.x0=at.pageX,this.y0=at.pageY,this.clientX0=at.clientX,this.clientY0=at.clientY,this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.button=e.button,this.target=i,this.t0=ht,this.type=t+(n||""),yt.active&&(this.detail="inertia"),s&&(this.relatedTarget=s),dt&&"inertia"===dt.detail&&!yt.active&&y.inertia.zeroResumeDelta?this.dx=this.dy=0:"end"===n||"drop"===t?"client"===l?(this.dx=a.x-at.clientX,this.dy=a.y-at.clientY):(this.dx=f.x-at.pageX,this.dy=f.y-at.pageY):"inertiastart"===n?(this.dx=dt.dx,this.dy=dt.dy):"client"===l?(this.dx=a.x-dt.clientX,this.dy=a.y-dt.clientY):(this.dx=f.x-dt.pageX,this.dy=f.y-dt.pageY),"resize"===t?y.squareResize||e.shiftKey?("y"===Xt?this.dx=this.dy:this.dy=this.dx,this.axes="xy"):(this.axes=Xt,"x"===Xt?this.dy=0:"y"===Xt&&(this.dx=0)):"gesture"===t&&(this.touches=rt?[ct[0],ct[1]]:e.touches,"start"===n?(this.distance=p(e),this.box=h(e),this.scale=1,this.ds=0,this.angle=d(e),this.da=0):"end"===n||e instanceof S?(this.distance=dt.distance,this.box=dt.box,this.scale=dt.scale,this.ds=this.scale-1,this.angle=dt.angle,this.da=this.angle-bt.startAngle):(this.distance=p(e),this.box=h(e),this.scale=this.distance/bt.startDistance,this.angle=d(e,bt.prevAngle),this.ds=this.scale-bt.prevScale,this.da=this.angle-bt.prevAngle)),"start"===n)this.timeStamp=ht,this.dt=0,this.duration=0,this.speed=0,this.velocityX=0,this.velocityY=0;else if("inertiastart"===n)this.timeStamp=(new Date).getTime(),this.dt=dt.dt,this.duration=dt.duration,this.speed=dt.speed,this.velocityX=dt.velocityX,this.velocityY=dt.velocityY;else{this.timeStamp=(new Date).getTime(),this.dt=this.timeStamp-dt.timeStamp,this.duration=this.timeStamp-ht;var E,x,T;"end"===n||e instanceof S?(T=Math.max(("end"===n?this.duration:this.dt)/1e3,.001),E=this[m]-dt[m],x=this[g]-dt[g],this.snap&&this.snap.locked&&(E-=this.snap.dx,x-=this.snap.dy),this.restrict&&(E-=this.restrict.dx,x-=this.restrict.dy),dt.snap&&dt.snap.locked&&(E-=dt[m]-dt.snap.dx,x-=dt[g]-dt.snap.dy),dt.restrict&&(E+=dt.restrict.dx,x+=dt.restrict.dy),this.speed=st(E,x)/T,this.velocityX=E/T,this.velocityY=x/T):(this.speed=ft[l+"Speed"],this.velocityX=ft[l+"VX"],this.velocityY=ft[l+"VY"])}}function x(){this.originalEvent.preventDefault()}function T(e,t,n){var r,i,s={};for(r in e)e.hasOwnProperty(r)&&(s[r]=e[r]);s.preventDefault=x,s.stopPropagation=S.prototype.stopPropagation,s.stopImmediatePropagation=S.prototype.stopImmediatePropagation,s.timeStamp=(new Date).getTime(),s.originalEvent=e,s.dt=s.timeStamp-ht,s.type="tap";var o=s.timeStamp-vt,u=mt&&"dubletap"!==mt.type&&mt.target===s.target&&500>o;for(vt=s.timeStamp,i=0;i<t.length;i++){var a=v(t[i],n[i]);if(s.pageX-=a.x,s.pageY-=a.y,s.clientX-=a.x,s.clientY-=a.y,s.currentTarget=n[i],t[i].fire(s),s.immediatePropagationStopped||s.propagationStopped&&t[i+1]!==s.currentTarget)break}if(u){var f={};for(r in s)f[r]=s[r];for(f.dt=o,f.type="doubletap",i=0;i<t.length&&(f.currentTarget=n[i],t[i].fire(f),!(f.immediatePropagationStopped||f.propagationStopped&&t[i+1]!==f.currentTarget));i++);mt=f}else mt=s}function N(e){if(!pt||!qt&&e instanceof pt.constructor&&pt.target===e.target){for(var t=[],n=[],r=e.target;r;){V.isSet(r)&&(t.push(V(r)),n.push(r));for(var i in xt){var s=Element.prototype[en]===K?Q.querySelectorAll(i):void 0;r!==Q&&r[en](i,s)&&(t.push(xt[i]),n.push(r))}r=r.parentNode}t.length&&T(e,t,n)}}function C(e,t){if("string"!=typeof e)return null;t=t||Lt;var n=-1!==e.indexOf("resize")?"resize":e,r=(t||Lt).options;return("resize"===n&&r.resizable||"drag"===e&&r.draggable||"gesture"===e&&r.gesturable)&&$t[n]?(("resize"===e||"resizeyx"===e)&&(e="resizexy"),e):null}function k(e){if(Jt&&pt&&e.type!==pt.type)return void (/^input$|^textarea$/i.test(Lt._element.nodeName)||e.preventDefault());if(!(pt&&"mousedown"===e.type&&"touchstart"===pt.type&&e.timeStamp-pt.timeStamp<300)){var t,n=e.target instanceof et?e.target.correspondingUseElement:e.target;if(rt&&_(e),yt.active&&Lt.selector)for(;n&&n!==Q;){if(n===yt.targetElement&&C(Lt.getAction(e))===Jt)return nn(yt.i),yt.active=!1,void (rt&&_(e,kt));n=n.parentNode}if(!(Ut||Wt||Rt)){if(Nt.length&&/mousedown|pointerdown/i.test(e.type))t=F(e,Nt);else for(var i,s;n&&n!==Q&&!t;){Nt=[];for(i in xt)s=Element.prototype[en]===K?Q.querySelectorAll(i):void 0,n[en](i,s)&&(xt[i]._element=n,Nt.push(xt[i]));t=F(e,Nt),n=n.parentNode}return t?(It=!0,Jt=t,L(e,t)):(ht=(new Date).getTime(),pt=e,r(ot,e),qt=!1,void 0)}}}function L(e,t){if(!t&&It&&pt&&e.type!==pt.type)return void (/^input$|^textarea$/i.test(Lt._element.nodeName)||e.preventDefault());It=!0,rt&&_(e),((e.touches&&e.touches.length<2||lt&&lt.length<2)&&!Lt||!Jt)&&(Lt=wt.get(e.currentTarget));var n=Lt&&Lt.options;if(Lt&&!(Ut||Wt||Rt)){var i=C(t||Lt.getAction(e));if(r(at,e),rt&&e instanceof rt&&(Lt._gesture.target||(Lt._gesture.target=Lt._element),_(e,Lt._gesture)),!i)return e;qt=!1,n.styleCursor&&(Q.documentElement.style.cursor=Vt[i].cursor),Xt="resizexy"===i?"xy":"resizex"===i?"x":"resizey"===i?"y":"","gesture"===i&&(e.touches&&e.touches.length<2||rt&&lt.length<2)&&(i=null),Jt=i,Pt.x=null,Pt.y=null,ht=(new Date).getTime(),pt=e,r(ot,e),qt=!1,/^input$|^textarea$/i.test(Lt._element.nodeName)||e.preventDefault()}else yt.active&&e.currentTarget===yt.targetElement&&Lt===yt.target&&C(Lt.getAction(e))===Jt&&(nn(yt.i),yt.active=!1,rt&&(Lt._gesture.target||(Lt._gesture.target=Lt._element),_(e,Lt._gesture)))}function A(e,t){var n,r,i,s,u,a,f,l,c,h,p=Lt.options.snap,d=p.anchors;if(t=t||Pt,t.useStatusXY)n={x:t.x,y:t.y};else{var m=v(Lt);n=o(e),n.x-=m.x,n.y-=m.y}if(t.realX=n.x,t.realY=n.y,p.range<0&&(p.range=1/0),"path"===p.mode)for(d=[],c=0,h=p.paths.length;h>c;c++){var g=p.paths[c];"function"==typeof g&&(g=g(n.x,n.y)),d.push({x:"number"==typeof g.x?g.x:n.x,y:"number"==typeof g.y?g.y:n.y,range:"number"==typeof g.range?g.range:p.range})}if("anchor"!==p.mode&&"path"!==p.mode||!d.length){if("grid"===p.mode){var y=Math.round((n.x-p.gridOffset.x)/p.grid.x),b=Math.round((n.y-p.gridOffset.y)/p.grid.y),w=y*p.grid.x+p.gridOffset.x,E=b*p.grid.y+p.gridOffset.y;a=w-n.x,f=E-n.y,l=st(a,f),s=l<p.range,u=w!==t.x||E!==t.y,t.x=w,t.y=E,t.dx=a,t.dy=f,t.range=p.range}}else{for(r={anchor:null,distance:0,range:0,dx:0,dy:0},c=0,h=d.length;h>c;c++){var S=d[c];i="number"==typeof S.range?S.range:p.range,a=S.x-n.x,f=S.y-n.y,l=st(a,f),s=i>l,1/0===i&&r.inRange&&1/0!==r.range&&(s=!1),(!r.anchor||(s?r.inRange&&1/0!==i?l/i<r.distance/r.range:l<r.distance:!r.inRange&&l<r.distance))&&(1/0===i&&(s=!0),r.anchor=S,r.distance=l,r.range=i,r.inRange=s,r.dx=a,r.dy=f,t.range=i)}s=r.inRange,u=r.anchor.x!==t.x||r.anchor.y!==t.y,t.x=r.anchor.x,t.y=r.anchor.y,t.dx=r.dx,t.dy=r.dy}return t.changed=u||s&&!t.locked,t.locked=s,t}function O(e,t){var r,i=V.currentAction()||Jt,s=Lt&&Lt.options.restrict[i];if(t=t||Ht,r=r=t.useStatusXY?{x:t.x,y:t.y}:o(e),t.snap&&t.snap.locked&&(r.x+=t.snap.dx||0,r.y+=t.snap.dy||0),t.dx=0,t.dy=0,t.restricted=!1,!i||!s)return t;var u;return"parent"===s?s=Lt._element.parentNode:"self"===s&&(s=Lt._element),n(s)?u=f(s):("function"==typeof s&&(s=s(r.x,r.y,Lt._element)),u=s,"x"in s&&"y"in s&&(u={left:s.x,top:s.y,right:s.x+s.width,bottom:s.y+s.height})),t.dx=Math.max(Math.min(u.right,r.x),u.left)-r.x,t.dy=Math.max(Math.min(u.bottom,r.y),u.top)-r.y,t.restricted=!0,t}function M(e,t){if(It){if(e instanceof S||r(ut,e),!qt){var n=ut.clientX-ot.clientX,s=ut.clientY-ot.clientY;qt=st(n,s)>1}if(Jt&&("mousemove"!==e.type||"touchstart"!==pt.type)){if(qt&&(!yt.active||e instanceof S&&/inertiastart/.test(e.type))&&(Ut||Wt||Rt||i(ft,ot,ut),Jt&&Lt)){var o=Lt.options.restrictEnabled&&(!Lt.options.restrict.endOnly||t),u=!(Ut||Wt||Rt),a=u?pt:e;u&&(dt=pt),o||(Ht.restricted=!1),!Lt.options.snapEnabled||-1===Lt.options.snap.actions.indexOf(Jt)||Lt.options.snap.endOnly&&!t?(o&&O(e),Vt[Jt].moveListener(e)):(A(a),(Pt.changed||!Pt.locked||o)&&(o&&O(e),Vt[Jt].moveListener(e)))}e instanceof S||(i(ft,ot,ut),r(ot,e)),(Ut||Wt)&&Bt.edgeMove(e)}}}function _(e,t){if(!lt.length||ct[0].pointerType===e.pointerType){t&&t.addPointer(e.pointerId);var n=lt.indexOf(e.pointerId);-1===n?(lt.push(e.pointerId),ct[lt.length-1]=e):ct[n]=e}}function D(e){var t=lt.indexOf(e.pointerId);-1!==t&&lt.splice(t,1)}function P(e){var t=lt.indexOf(e.pointerId);-1!==t&&(/move/i.test(e.type)?ct[t]=e:/up|cancel/i.test(e.type)&&(D(e),Rt&&lt.length<2&&Lt._gesture.stop()))}function H(e){e.preventDefault();var t,n,r,i,s;if(!Ut){if(t=new S(pt,"drag","start"),Ut=!0,Lt.fire(t),!zt){m(Et);for(var o=0;o<Tt.length;o++)Tt[o]._elements=Q.querySelectorAll(Tt[o].selector)}dt=t,Lt.options.snapEnabled&&!Lt.options.snap.endOnly&&A(e)}t=new S(e,"drag","move");var u=Lt._element,a=E(t,u);a?(i=a.dropzone,Ot=a.element):i=Ot=null,Lt._element=u,Ot!==_t&&(Mt&&(r=new S(e,"drag","leave",_t,u),t.dragLeave=_t,s=Mt,Mt=_t=null),i&&(n=new S(e,"drag","enter",Ot,u),t.dragEnter=i._element,Mt=i,_t=Mt._element)),Lt.fire(t),r&&s.fire(r),n&&i.fire(n),dt=t}function B(e){e.preventDefault();var t;Wt||(t=new S(pt,"resize","start"),Lt.fire(t),Lt.fire(t),Wt=!0,dt=t,Lt.options.snapEnabled&&!Lt.options.snap.endOnly&&A(e)),t=new S(e,"resize","move"),Lt.fire(t),dt=t}function j(e){if(e.touches&&!(e.touches.length<2)||rt){e.preventDefault();var t;Rt||(t=new S(pt,"gesture","start"),t.ds=0,bt.startDistance=bt.prevDistance=t.distance,bt.startAngle=bt.prevAngle=t.angle,bt.scale=1,Rt=!0,Lt.fire(t),dt=t,Lt.options.snapEnabled&&!Lt.options.snap.endOnly&&A(e)),t=new S(e,"gesture","move"),t.ds=t.scale-bt.scale,Lt.fire(t),dt=t,bt.prevAngle=t.angle,bt.prevDistance=t.distance,1/0===t.scale||null===t.scale||void 0===t.scale||isNaN(t.scale)||(bt.scale=t.scale)}}function F(e,t){for(var n=0,r=t.length;r>n;n++){var i=t[n],s=C(i.getAction(e,i),i);if(s)return Lt=i,s}}function I(e){if(!(It||Ut||Wt||Rt)){var t=[],n=Lt&&Lt._element,r=e.target instanceof et?e.target.correspondingUseElement:e.target;for(var i in xt)xt.hasOwnProperty(i)&&xt[i]&&r[en](i)&&(xt[i]._element=r,t.push(xt[i]));var s=wt.get(r),o=s&&C(s.getAction(e),s);if(o)Lt=s,Nt=[];else if(F(e,t))Nt=t,R(e,Nt),an.addToElement(r,"mousemove",R);else if(Lt){var u=n.querySelectorAll("*");if(-1!==Array.prototype.indexOf.call(u,r)){for(var a=0;a<Nt.length;a++)Nt[a]._element=n;R(e,Nt),an.addToElement(Lt._element,"mousemove",R)}else Lt=null,Nt=[]}}}function q(e){if(!(It||Ut||Wt||Rt)){var t=e.target instanceof et?e.target.correspondingUseElement:e.target;wt.get(t)||an.removeFromElement(t,R),Lt&&Lt.options.styleCursor&&!(Ut||Wt||Rt)&&(Q.documentElement.style.cursor="")}}function R(e,t){if(It||Ut||Wt||Rt)Jt&&e.preventDefault();else{var n;t?n=F(e,t):Lt&&(n=C(Lt.getAction(e))),Lt&&Lt.options.styleCursor&&(Q.documentElement.style.cursor=n?Vt[n].cursor:"")}}function U(e){if((e instanceof S||rt||!It||!pt||e instanceof pt.constructor)&&!(e.touches&&e.touches.length>=2)){if(it&&e instanceof it&&/inertiastart/i.test(e.type))return void e.gestureObject.stop();var t,n,r=Lt&&Lt.options.inertia;if(Ut||Wt||Rt){if(yt.active)return;var i=Lt.options.deltaSource,s=ft[i+"Speed"];if(Lt.options.inertiaEnabled&&"gesture"!==Jt&&-1!==r.actions.indexOf(Jt)&&e!==yt.startEvent&&(new Date).getTime()-ut.timeStamp<50&&s>r.minSpeed&&s>r.endSpeed){var o,u=r.resistance,a=-Math.log(r.endSpeed/s)/u;if(yt.active=!0,yt.target=Lt,yt.targetElement=Lt._element,an.useAttachEvent)for(n in e)e.hasOwnProperty(n)&&(yt.pointerUp[n]=e[n]);else yt.pointerUp=e;yt.startEvent=o=new S(e,"drag","inertiastart"),yt.vx0=ft[i+"VX"],yt.vy0=ft[i+"VY"],yt.v0=s,yt.x0=dt.pageX,yt.y0=dt.pageY,yt.t0=yt.startEvent.timeStamp/1e3,yt.sx=yt.sy=0,yt.modifiedXe=yt.xe=(yt.vx0-a)/u,yt.modifiedYe=yt.ye=(yt.vy0-a)/u,yt.te=a,yt.lambda_v0=u/yt.v0,yt.one_ve_v0=1-r.endSpeed/yt.v0;var f,l=o.pageX,c=o.pageY;if(o.snap&&o.snap.locked&&(l-=o.snap.dx,c-=o.snap.dy),o.restrict&&(l-=o.restrict.dx,c-=o.restrict.dy),f={useStatusXY:!0,x:l+yt.xe,y:c+yt.ye,dx:0,dy:0,snap:null},f.snap=f,Lt.options.snapEnabled&&Lt.options.snap.endOnly){var h=A(e,f);h.locked&&(yt.modifiedXe+=h.dx,yt.modifiedYe+=h.dy)}if(Lt.options.restrictEnabled&&Lt.options.restrict.endOnly){var p=O(e,f);yt.modifiedXe+=p.dx,yt.modifiedYe+=p.dy}return nn(yt.i),yt.i=tn(g),void Lt.fire(yt.startEvent)}(Lt.options.snapEnabled&&Lt.options.snap.endOnly||Lt.options.restrictEnabled&&Lt.options.restrict.endOnly)&&M(e,!0)}if(Ut){t=new S(e,"drag","end");var d,v=Lt._element,m=E(t,v);if(m?(At=m.dropzone,Ot=m.element):(At=null,Ot=null),Lt._element=v,At)d=new S(e,"drop",null,Ot,v),t.dropzone=Ot;else if(Mt){var y=new S(e,"drag","leave",Ot,v);Mt.fire(y,v),t.dragLeave=_t}Lt.fire(t),d&&At.fire(d)}else Wt?(t=new S(e,"resize","end"),Lt.fire(t)):Rt&&(t=new S(e,"gesture","end"),Lt.fire(t));V.stop()}}function z(e,t){var n,r,i={},s=Ct[e.type],o=e.target;t=t?!0:!1;for(var u in e)i[u]=e[u];for(i.preventDefault=function(){e.preventDefault()};o&&o!==Q;){for(n in s)if(o[en](n)){var a=s[n];for(i.currentTarget=o,r=0;r<a.length;r++)if(a[r][1]===t)try{a[r][0](i)}catch(f){G.error('Error thrown from delegated listener: "'+n+'" '+e.type+" "+(a[r][0].name?a[r][0].name:"")),G.log(f)}}o=o.parentNode}}function W(e){return z.call(this,e,!0)}function X(){Lt&&!Lt.selector&&(Lt=null),At=Ot=Mt=_t=null}function V(e){return wt.get(e)||new J(e)}function $(e){for(var t in Dt)e.hasOwnProperty(t)&&typeof e[t]==typeof Dt[t]&&(this[t]=e[t])}function J(e,t){this._element=e,this._iEvents=this._iEvents||{},"string"==typeof e?(Q.querySelector(e),xt[e]=this,this.selector=e,this._gesture=kt):(n(e)&&(rt?(an.add(this,"pointerdown",L),an.add(this,"pointermove",R),this._gesture=new nt,this._gesture.target=e):(an.add(this,"mousedown",L),an.add(this,"mousemove",R),an.add(this,"touchstart",L),an.add(this,"touchmove",R))),St.push(this)),wt.push(this),this.set(t)}var K,Q=e.document,G=e.console,Y=e.SVGElement||t,Z=e.SVGSVGElement||t,et=e.SVGElementInstance||t,tt=e.HTMLElement||e.Element,nt=e.Gesture||e.MSGesture,rt=nt&&(e.PointerEvent||e.MSPointerEvent),it=nt&&(e.GestureEvent||e.MSGestureEvent),st=Math.hypot||function(e,t){return Math.sqrt(e*e+t*t)},ot={pageX:0,pageY:0,clientX:0,clientY:0,timeStamp:0},ut={pageX:0,pageY:0,clientX:0,clientY:0,timeStamp:0},at={pageX:0,pageY:0,clientX:0,clientY:0,timeStamp:0},ft={pageX:0,pageY:0,clientX:0,clientY:0,timeStamp:0,pageSpeed:0,clientSpeed:0},lt=rt?[]:null,ct=rt?[]:null,ht=0,pt=null,dt=null,vt=0,mt=null,gt={},yt={active:!1,target:null,targetElement:null,startEvent:null,pointerUp:{},xe:0,ye:0,duration:0,t0:0,vx0:0,vys:0,lambda_v0:0,one_ve_v0:0,i:null},bt={start:{x:0,y:0},startDistance:0,prevDistance:0,distance:0,scale:1,startAngle:0,prevAngle:0},wt=[],Et=[],St=[],xt={},Tt=[],Nt=[],Ct={},kt=null,Lt=null,At=null,Ot=null,Mt=null,_t=null,Dt={draggable:!1,dropzone:!1,accept:null,resizable:!1,squareResize:!1,resizeAxis:"xy",gesturable:!1,styleCursor:!0,snap:{mode:"grid",endOnly:!1,actions:["drag"],range:1/0,grid:{x:100,y:100},gridOffset:{x:0,y:0},anchors:[],paths:[],arrayTypes:/^anchors$|^paths$|^actions$/,objectTypes:/^grid$|^gridOffset$/,stringTypes:/^mode$/,numberTypes:/^range$/,boolTypes:/^endOnly$/},snapEnabled:!1,restrict:{drag:null,resize:null,gesture:null,endOnly:!1},restrictEnabled:!0,autoScroll:{container:e,margin:60,speed:300,numberTypes:/^margin$|^speed$/},autoScrollEnabled:!1,inertia:{resistance:10,minSpeed:100,endSpeed:10,actions:["drag","resize"],zeroResumeDelta:!1,numberTypes:/^resistance$|^minSpeed$|^endSpeed$/,arrayTypes:/^actions$/,boolTypes:/^zeroResumeDelta$/},inertiaEnabled:!1,origin:{x:0,y:0},deltaSource:"page"},Pt={locked:!1,x:0,y:0,dx:0,dy:0,realX:0,realY:0,anchors:[],paths:[]},Ht={dx:0,dy:0,snap:Pt,restricted:!1},Bt={target:null,i:null,x:0,y:0,scroll:function(){var t=Bt.target.options.autoScroll,n=t.container,r=(new Date).getTime(),i=(r-Bt.prevTime)/1e3,s=t.speed*i;s>=1&&(n instanceof e.Window?n.scrollBy(Bt.x*s,Bt.y*s):n&&(n.scrollLeft+=Bt.x*s,n.scrollTop+=Bt.y*s),Bt.prevTime=r),Bt.isScrolling&&(nn(Bt.i),Bt.i=tn(Bt.scroll))},edgeMove:function(t){if(Lt&&Lt.options.autoScrollEnabled&&(Ut||Wt)){var n,r,i,s,o=Lt.options.autoScroll;if(o.container instanceof e.Window)s=t.clientX<Bt.margin,n=t.clientY<Bt.margin,r=t.clientX>o.container.innerWidth-Bt.margin,i=t.clientY>o.container.innerHeight-Bt.margin;else{var u=f(o.container);s=t.clientX<u.left+Bt.margin,n=t.clientY<u.top+Bt.margin,r=t.clientX>u.right-Bt.margin,i=t.clientY>u.bottom-Bt.margin}Bt.x=r?1:s?-1:0,Bt.y=i?1:n?-1:0,Bt.isScrolling||(Bt.margin=o.margin,Bt.speed=o.speed,Bt.start(Lt))}},isScrolling:!1,prevTime:0,start:function(e){Bt.isScrolling=!0,nn(Bt.i),Bt.target=e,Bt.prevTime=(new Date).getTime(),Bt.i=tn(Bt.scroll)},stop:function(){Bt.isScrolling=!1,nn(Bt.i)}},jt="createTouch"in Q,Ft=jt?20:10,It=!1,qt=!1,Rt=!1,Ut=!1,zt=!1,Wt=!1,Xt="xy",Vt={drag:{cursor:"move",moveListener:H},resizex:{cursor:"e-resize",moveListener:B},resizey:{cursor:"s-resize",moveListener:B},resizexy:{cursor:"se-resize",moveListener:B},gesture:{cursor:"",moveListener:j}},$t={drag:!0,resize:!0,gesture:!0},Jt=null,Kt="onmousewheel"in Q?"mousewheel":"wheel",Qt=["dragstart","dragmove","draginertiastart","dragend","dragenter","dragleave","drop","resizestart","resizemove","resizeinertiastart","resizeend","gesturestart","gesturemove","gestureinertiastart","gestureend","tap","doubletap"],Gt={},Yt={directBind:0,onevent:1,globalBind:2},Zt="Opera"==navigator.appName&&jt&&navigator.userAgent.match("Presto"),en="matchesSelector"in Element.prototype?"matchesSelector":"webkitMatchesSelector"in Element.prototype?"webkitMatchesSelector":"mozMatchesSelector"in Element.prototype?"mozMatchesSelector":"oMatchesSelector"in Element.prototype?"oMatchesSelector":"msMatchesSelector",tn=e.requestAnimationFrame,nn=e.cancelAnimationFrame,rn={_element:e,events:{}},sn={_element:Q,events:{}},on={_element:e.parent,events:{}},un={_element:null,events:{}},an=function(){function t(e,t,n,r){var o=a.indexOf(e),c=f[o];if(c||(c={events:{},typeCount:0},o=a.push(e)-1,f.push(c),l.push(i?{supplied:[],wrapped:[],useCount:[]}:null)),c.events[t]||(c.events[t]=[],c.typeCount++),-1===c.events[t].indexOf(n)){var h;if(i){var p=l[o],d=p.supplied.indexOf(n),v=p.wrapped[d]||function(t){t.immediatePropagationStopped||(t.target=t.srcElement,t.currentTarget=e,/mouse|click/.test(t.type)&&(t.pageX=t.clientX+Q.documentElement.scrollLeft,t.pageY=t.clientY+Q.documentElement.scrollTop),n(t))};h=e[s](u+t,v,Boolean(r)),-1===d?(p.supplied.push(n),p.wrapped.push(v),p.useCount.push(1)):p.useCount[d]++}else h=e[s](t,n,r||!1);return c.events[t].push(n),h}}function n(e,t,r,s){var c,h,p,d=a.indexOf(e),v=f[d],m=r;if(v&&v.events)if(i&&(h=l[d],p=h.supplied.indexOf(r),m=h.wrapped[p]),"all"!==t){if(v.events[t]){var g=v.events[t].length;if("all"===r)for(c=0;g>c;c++)n(e,t,v.events[t][c],Boolean(s));else for(c=0;g>c;c++)if(v.events[t][c]===r){e[o](u+t,m,s||!1),v.events[t].splice(c,1),i&&h&&(h.useCount[p]--,0===h.useCount[p]&&(h.supplied.splice(p,1),h.wrapped.splice(p,1),h.useCount.splice(p,1)));break}v.events[t]&&0===v.events[t].length&&(v.events[t]=null,v.typeCount--)}v.typeCount||(f.splice(d),a.splice(d),l.splice(d))}else for(t in v.events)v.events.hasOwnProperty(t)&&n(e,t,"all")}var r=e.Event,i="attachEvent"in e&&!("addEventListener"in e),s=i?"attachEvent":"addEventListener",o=i?"detachEvent":"removeEventListener",u=i?"on":"",a=[],f=[],l=[];return"indexOf"in Array.prototype||(Array.prototype.indexOf=function(e){var t=this.length>>>0,n=Number(arguments[1])||0;for(n=0>n?Math.ceil(n):Math.floor(n),0>n&&(n+=t);t>n;n++)if(n in this&&this[n]===e)return n;return-1}),"stopPropagation"in r.prototype||(r.prototype.stopPropagation=function(){this.cancelBubble=!0},r.prototype.stopImmediatePropagation=function(){this.cancelBubble=!0,this.immediatePropagationStopped=!0}),"preventDefault"in r.prototype||(r.prototype.preventDefault=function(){this.returnValue=!1}),"hasOwnProperty"in r.prototype||(r.prototype.hasOwnProperty=Object.prototype.hasOwnProperty),{add:function(e,n,r,i){t(e._element,n,r,i)},remove:function(e,t,r,i){n(e._element,t,r,i)},addToElement:t,removeFromElement:n,useAttachEvent:i}}();S.prototype={preventDefault:t,stopImmediatePropagation:function(){this.immediatePropagationStopped=this.propagationStopped=!0},stopPropagation:function(){this.propagationStopped=!0}},wt.indexOfElement=Et.indexOfElement=function(e){for(var t=0;t<this.length;t++){var n=this[t];if(n.selector===e||!n.selector&&n._element===e)return t}return-1},wt.get=function(e){return"string"==typeof e?xt[e]:this[this.indexOfElement(e)]},Et.get=function(e){return this[this.indexOfElement(e)]},$.prototype=Dt,J.prototype={setOnEvents:function(e,t){if("drop"===e){var n=t.ondrop||t.onDrop||t.drop,r=t.ondragenter||t.onDropEnter||t.dragenter,i=t.ondragleave||t.onDropLeave||t.dragleave;"function"==typeof n&&(this.ondrop=n),"function"==typeof r&&(this.ondragenter=r),"function"==typeof i&&(this.ondragleave=i)}else{var s=t.onstart||t.onStart||t.start,o=t.onmove||t.onMove||t.move,u=t.onend||t.onEnd||t.end,a=t.oninertiastart||t.onInertiaStart||t.inertiastart;e="on"+e,"function"==typeof s&&(this[e+"start"]=s),"function"==typeof o&&(this[e+"move"]=o),"function"==typeof u&&(this[e+"end"]=u),"function"==typeof a&&(this[e+"inertiastart"]=a)}return this},draggable:function(e){return e instanceof Object?(this.options.draggable=!0,this.setOnEvents("drag",e),this):"boolean"==typeof e?(this.options.draggable=e,this):null===e?(delete this.options.draggable,this):this.options.draggable},dropzone:function(e){if(e instanceof Object)return this.options.dropzone=!0,this.setOnEvents("drop",e),this.accept(e.accept),(this.selector?Tt:Et).push(this),zt||this.selector||(this.rect=this.getRect()),this;if("boolean"==typeof e){if(e)(this.selector?Tt:Et).push(this),zt||this.selector||(this.rect=this.getRect());else{var t=this.selector?Tt:Et,n=t.indexOf(this);-1!==n&&t.splice(n,1)}return this.options.dropzone=e,this}return null===e?(delete this.options.dropzone,this):this.options.dropzone},dropCheck:function(e,t,n){var r,i,s=o(e),u=v(t,n);return s.x+=u.x,s.y+=u.y,zt&&(this.rect=this.getRect()),this.rect?(r=s.x>this.rect.left&&s.x<this.rect.right,i=s.y>this.rect.top&&s.y<this.rect.bottom,r&&i):!1},dropChecker:function(e){return"function"==typeof e?(this.dropCheck=e,this):this.dropCheck},accept:function(e){return n(e)?(this.options.accept=e,this):"string"==typeof e?(Q.querySelector(e),this.options.accept=e,this):null===e?(delete this.options.accept,this):this.options.accept},resizable:function(e){return e instanceof Object?(this.options.resizable=!0,this.setOnEvents("resize",e),/^x$|^y$|^xy$/.test(e.axis)?this.options.resizeAxis=e.axis:null===e.axis&&(this.options.resizeAxis=Dt.resizeAxis),this):"boolean"==typeof e?(this.options.resizable=e,this):this.options.resizable},resizeable:t,squareResize:function(e){return"boolean"==typeof e?(this.options.squareResize=e,this):null===e?(delete this.options.squareResize,this):this.options.squareResize},gesturable:function(e){return e instanceof Object?(this.options.gesturable=!0,this.setOnEvents("gesture",e),this):"boolean"==typeof e?(this.options.gesturable=e,this):null===e?(delete this.options.gesturable,this):this.options.gesturable},gestureable:t,autoScroll:function(t){var r=Dt.autoScroll;if(t instanceof Object){var i=this.options.autoScroll;return i===r&&(i=this.options.autoScroll={margin:r.margin,distance:r.distance,interval:r.interval,container:r.container}),i.margin=this.validateSetting("autoScroll","margin",t.margin),i.speed=this.validateSetting("autoScroll","speed",t.speed),i.container=n(t.container)||t.container instanceof e.Window?t.container:r.container,this.options.autoScrollEnabled=!0,this.options.autoScroll=i,this}return"boolean"==typeof t?(this.options.autoScrollEnabled=t,this):null===t?(delete this.options.autoScrollEnabled,delete this.options.autoScroll,this):this.options.autoScrollEnabled?this.options.autoScroll:!1},snap:function(e){var t=Dt.snap;if(e instanceof Object){var n=this.options.snap;return n===t&&(n={}),n.mode=this.validateSetting("snap","mode",e.mode),n.endOnly=this.validateSetting("snap","endOnly",e.endOnly),n.actions=this.validateSetting("snap","actions",e.actions),n.range=this.validateSetting("snap","range",e.range),n.paths=this.validateSetting("snap","paths",e.paths),n.grid=this.validateSetting("snap","grid",e.grid),n.gridOffset=this.validateSetting("snap","gridOffset",e.gridOffset),n.anchors=this.validateSetting("snap","anchors",e.anchors),this.options.snapEnabled=!0,this.options.snap=n,this}return"boolean"==typeof e?(this.options.snapEnabled=e,this):null===e?(delete this.options.snapEnabled,delete this.options.snap,this):this.options.snapEnabled?this.options.snap:!1},inertia:function(e){var t=Dt.inertia;if(e instanceof Object){var n=this.options.inertia;return n===t&&(n=this.options.inertia={resistance:t.resistance,minSpeed:t.minSpeed,endSpeed:t.endSpeed,actions:t.actions,zeroResumeDelta:t.zeroResumeDelta}),n.resistance=this.validateSetting("inertia","resistance",e.resistance),n.minSpeed=this.validateSetting("inertia","minSpeed",e.minSpeed),n.endSpeed=this.validateSetting("inertia","endSpeed",e.endSpeed),n.actions=this.validateSetting("inertia","actions",e.actions),n.zeroResumeDelta=this.validateSetting("inertia","zeroResumeDelta",e.zeroResumeDelta),this.options.inertiaEnabled=!0,this.options.inertia=n,this}return"boolean"==typeof e?(this.options.inertiaEnabled=e,this):null===e?(delete this.options.inertiaEnabled,delete this.options.inertia,this):this.options.inertiaEnabled?this.options.inertia:!1},getAction:function(e){var t,n,r,i=this.getRect(),s=o(e),u=this.options;return $t.resize&&u.resizable&&(t="y"!==u.resizeAxis&&s.x>i.right-Ft,n="x"!==u.resizeAxis&&s.y>i.bottom-Ft),Xt=(t?"x":"")+(n?"y":""),r=Xt?"resize"+Xt:$t.drag&&u.draggable?"drag":null,$t.gesture&&(e.touches&&e.touches.length>=2||rt&&lt.length>=2)&&!Ut&&!Wt&&(r="gesture"),r},actionChecker:function(e){return"function"==typeof e?(this.getAction=e,this):null===e?(delete this.options.getAction,this):this.getAction},getRect:function(){return this.selector&&!n(this._element)&&(this._element=Q.querySelector(this.selector)),f(this._element)},rectChecker:function(e){return"function"==typeof e?(this.getRect=e,this):null===e?(delete this.options.getRect,this):this.getRect},styleCursor:function(e){return"boolean"==typeof e?(this.options.styleCursor=e,this):null===e?(delete this.options.styleCursor,this):this.options.styleCursor},origin:function(e){return e instanceof Object||/^parent$|^self$/.test(e)?(this.options.origin=e,this):null===e?(delete this.options.origin,this):this.options.origin},deltaSource:function(e){return"page"===e||"client"===e?(this.options.deltaSource=e,this):null===e?(delete this.options.deltaSource,this):this.options.deltaSource},restrict:function(e){if(void 0===e)return this.options.restrict;if(e instanceof Object){var t={};(e.drag instanceof Object||/^parent$|^self$/.test(e.drag))&&(t.drag=e.drag),(e.resize instanceof Object||/^parent$|^self$/.test(e.resize))&&(t.resize=e.resize),(e.gesture instanceof Object||/^parent$|^self$/.test(e.gesture))&&(t.gesture=e.gesture),"boolean"==typeof e.endOnly&&(t.endOnly=e.endOnly),this.options.restrictEnabled=!0,this.options.restrict=t}else null===e&&(delete this.options.restrict,delete this.options.restrictEnabled);return this},validateSetting:function(e,t,r){var i=Dt[e],s=this.options[e];if(void 0!==i&&void 0!==i[t]){if("objectTypes"in i&&i.objectTypes.test(t))return r instanceof Object?r:t in s&&s[t]instanceof Object?s[t]:i[t];if("arrayTypes"in i&&i.arrayTypes.test(t))return r instanceof Array?r:t in s&&s[t]instanceof Array?s[t]:i[t];if("stringTypes"in i&&i.stringTypes.test(t))return"string"==typeof r?r:t in s&&"string"==typeof s[t]?s[t]:i[t];if("numberTypes"in i&&i.numberTypes.test(t))return"number"==typeof r?r:t in s&&"number"==typeof s[t]?s[t]:i[t];if("boolTypes"in i&&i.boolTypes.test(t))return"boolean"==typeof r?r:t in s&&"boolean"==typeof s[t]?s[t]:i[t];if("elementTypes"in i&&i.elementTypes.test(t))return n(r)?r:t in s&&n(s[t])?s[t]:i[t]}return null},element:function(){return this._element},fire:function(e){if(!e||!e.type||-1===Qt.indexOf(e.type))return this;for(var t,n,r=0,i=0,s="on"+e.type;3>r;)try{switch(r){case Yt.directBind:if(e.type in this._iEvents){for(t=this._iEvents[e.type],n=t.length;n>i&&!e.immediatePropagationStopped;i++)t[i](e);break}break;case Yt.onevent:"function"==typeof this[s]&&this[s](e);break;case Yt.globalBind:if(e.type in Gt&&(t=Gt[e.type]))for(n=t.length;n>i&&!e.immediatePropagationStopped;i++)t[i](e)}if(e.propagationStopped)break;i=0,r++}catch(o){G.error("Error thrown from "+e.type+" listener"),G.error(o),i++,r===Yt.onevent&&r++}return this},on:function(e,t,n){if("wheel"===e&&(e=Kt),-1!==Qt.indexOf(e))e in this._iEvents?-1===this._iEvents[e].indexOf(t)&&this._iEvents[e].push(t):this._iEvents[e]=[t];else if(this.selector){Ct[e]||(Ct[e]={});var r=Ct[e];r[this.selector]||(r[this.selector]=[]),r[this.selector].push([t,n?!0:!1]),an.add(sn,e,n?W:z,n)}else an.add(this,e,t,n);return this},off:function(e,t,n){var r,i=-1;if(n=n?!0:!1,"wheel"===e&&(e=Kt),-1!==Qt.indexOf(e))r=this._iEvents[e],r&&-1!==(i=r.indexOf(t))&&this._iEvents[e].splice(i,1);else if(this.selector){var s=Ct[e];if(s&&(r=s[this.selector])){for(i=0;i<r.length&&r[i][1]!==n;i++);i<r.length&&r.splice(i,1)}}else an.remove(this._element,t,n);return this},set:function(e){return e&&"object"==typeof e||(e={}),this.options=new $(e),this.draggable("draggable"in e?e.draggable:this.options.draggable),this.dropzone("dropzone"in e?e.dropzone:this.options.dropzone),this.resizable("resizable"in e?e.resizable:this.options.resizable),this.gesturable("gesturable"in e?e.gesturable:this.options.gesturable),"autoScroll"in e&&this.autoScroll(e.autoScroll),this},unset:function(){return an.remove(this,"all"),"string"==typeof this.selector?delete xt[this.selector]:(an.remove(this,"all"),this.options.styleCursor&&(this._element.style.cursor=""),this._gesture&&(this._gesture.target=null),St.splice(St.indexOf(this.element()))),this.dropzone(!1),wt.splice(wt.indexOf(this),1),V}},J.prototype.gestureable=J.prototype.gesturable,J.prototype.resizeable=J.prototype.resizable,V.isSet=function(e){return-1!==wt.indexOfElement(e)},V.on=function(e,t,n){return-1!==Qt.indexOf(e)?Gt[e]?-1===Gt[e].indexOf(t)&&Gt[e].push(t):Gt[e]=[t]:an.add(sn,e,t,n),V},V.off=function(e,t,n){if(-1===Qt.indexOf(e))an.remove(sn,e,t,n);else{var r;e in Gt&&-1!==(r=Gt[e].indexOf(t))&&Gt[e].splice(r,1)}return V},V.simulate=function(e,n,r){var i,s,o={};if("resize"===e&&(e="resizexy"),e in Vt){if(r)for(i in r)r.hasOwnProperty(i)&&(o[i]=r[i]);else s=Lt._element instanceof Y?n.getBoundingClientRect():s=n.getClientRects()[0],"drag"===e?(o.pageX=s.left+s.width/2,o.pageY=s.top+s.height/2):(o.pageX=s.right,o.pageY=s.bottom);return o.target=o.currentTarget=n,o.preventDefault=o.stopPropagation=t,L(o,e),V}return V},V.enableDragging=function(e){return null!==e&&void 0!==e?($t.drag=e,V):$t.drag},V.enableResizing=function(e){return null!==e&&void 0!==e?($t.resize=e,V):$t.resize},V.enableGesturing=function(e){return null!==e&&void 0!==e?($t.gesture=e,V):$t.gesture},V.eventTypes=Qt,V.debug=function(){return{target:Lt,dragging:Ut,resizing:Wt,gesturing:Rt,prepared:Jt,prevCoords:ot,downCoords:at,pointerIds:lt,pointerMoves:ct,addPointer:_,removePointer:D,recordPointers:P,inertia:yt,downTime:ht,downEvent:pt,prevEvent:dt,Interactable:J,IOptions:$,interactables:wt,dropzones:Et,pointerIsDown:It,defaultOptions:Dt,actions:Vt,dragMove:H,resizeMove:B,gestureMove:j,pointerUp:U,pointerDown:L,pointerMove:M,pointerHover:R,events:an,globalEvents:Gt,delegatedEvents:Ct}},V.getTouchAverage=c,V.getTouchBBox=h,V.getTouchDistance=p,V.getTouchAngle=d,V.getElementRect=f,V.margin=function(e){return"number"==typeof e?(Ft=e,V):Ft},V.styleCursor=function(e){return"boolean"==typeof e?(Dt.styleCursor=e,V):Dt.styleCursor},V.autoScroll=function(t){var r=Dt.autoScroll;return t instanceof Object?(Dt.autoScrollEnabled=!0,"number"==typeof t.margin&&(r.margin=t.margin),"number"==typeof t.speed&&(r.speed=t.speed),r.container=n(t.container)||t.container instanceof e.Window?t.container:r.container,V):"boolean"==typeof t?(Dt.autoScrollEnabled=t,V):Dt.autoScrollEnabled?r:!1},V.snap=function(e){var t=Dt.snap;return e instanceof Object?(Dt.snapEnabled=!0,"string"==typeof e.mode&&(t.mode=e.mode),"boolean"==typeof e.endOnly&&(t.endOnly=e.endOnly),"number"==typeof e.range&&(t.range=e.range),e.actions instanceof Array&&(t.actions=e.actions),e.anchors instanceof Array&&(t.anchors=e.anchors),e.grid instanceof Object&&(t.grid=e.grid),e.gridOffset instanceof Object&&(t.gridOffset=e.gridOffset),V):"boolean"==typeof e?(Dt.snapEnabled=e,V):{enabled:Dt.snapEnabled,mode:t.mode,actions:t.actions,grid:t.grid,gridOffset:t.gridOffset,anchors:t.anchors,paths:t.paths,range:t.range,locked:Pt.locked,x:Pt.x,y:Pt.y,realX:Pt.realX,realY:Pt.realY,dx:Pt.dx,dy:Pt.dy}},V.inertia=function(e){var t=Dt.inertia;return e instanceof Object?(Dt.inertiaEnabled=!0,"number"==typeof e.resistance&&(t.resistance=e.resistance),"number"==typeof e.minSpeed&&(t.minSpeed=e.minSpeed),"number"==typeof e.endSpeed&&(t.endSpeed=e.endSpeed),"boolean"==typeof e.zeroResumeDelta&&(t.zeroResumeDelta=e.zeroResumeDelta),e.actions instanceof Array&&(t.actions=e.actions),V):"boolean"==typeof e?(Dt.inertiaEnabled=e,V):{enabled:Dt.inertiaEnabled,resistance:t.resistance,minSpeed:t.minSpeed,endSpeed:t.endSpeed,actions:t.actions,zeroResumeDelta:t.zeroResumeDelta}},V.supportsTouch=function(){return jt},V.currentAction=function(){return Ut&&"drag"||Wt&&"resize"||Rt&&"gesture"||null},V.stop=function(e){if(Ut||Wt||Rt){Bt.stop(),Nt=[],Lt.options.styleCursor&&(Q.documentElement.style.cursor=""),Lt._gesture&&Lt._gesture.stop(),X();for(var t=0;t<Tt.length;t++)Tt._elements=[];e&&"function"==typeof e.preventDefault&&e.preventDefault()}return lt&&lt.length&&(lt.splice(0),ct.splice(0)),It=Pt.locked=Ut=Wt=Rt=!1,Jt=dt=null,V},V.dynamicDrop=function(e){return"boolean"==typeof e?(Ut&&zt!==e&&!e&&m(Et),zt=e,V):zt},V.deltaSource=function(e){return"page"===e||"client"===e?(Dt.deltaSource=e,this):Dt.deltaSource},V.restrict=function(e){var t=Dt.restrict;return void 0===e?Dt.restrict:(e instanceof Object?((e.drag instanceof Object||/^parent$|^self$/.test(e.drag))&&(t.drag=e.drag),(e.resize instanceof Object||/^parent$|^self$/.test(e.resize))&&(t.resize=e.resize),(e.gesture instanceof Object||/^parent$|^self$/.test(e.gesture))&&(t.gesture=e.gesture),"boolean"==typeof e.endOnly&&(t.endOnly=e.endOnly)):null===e&&(t.drag=t.resize=t.gesture=null,t.endOnly=!1),this)},rt?(an.add(sn,"pointerup",N),an.add(sn,"pointerdown",k),an.add(sn,"MSGestureChange",M),an.add(sn,"MSGestureEnd",U),an.add(sn,"MSInertiaStart",U),an.add(sn,"pointerover",I),an.add(sn,"pointerout",q),an.add(sn,"pointermove",P),an.add(sn,"pointerup",P),an.add(sn,"pointercancel",P),an.add(sn,"pointerup",function(){Ut||Wt||Rt||(It=!1)}),kt=new nt,kt.target=Q.documentElement):(an.add(sn,"mouseup",N),an.add(sn,"touchend",N),an.add(sn,"mousedown",k),an.add(sn,"mousemove",M),an.add(sn,"mouseup",U),an.add(sn,"mouseover",I),an.add(sn,"mouseout",q),an.add(sn,"touchstart",k),an.add(sn,"touchmove",M),an.add(sn,"touchend",U),an.add(sn,"touchcancel",U)),an.add(rn,"blur",U);try{e.frameElement&&(un._element=e.frameElement.ownerDocument,an.add(un,"mouseup",U),an.add(un,"touchend",U),an.add(un,"touchcancel",U),an.add(un,"pointerup",U),an.add(on,"blur",U))}catch(fn){V.windowParentError=fn}an.add(sn,"selectstart",function(e){(Ut||Wt||Rt)&&e.preventDefault()}),en in Element.prototype&&"function"==typeof Element.prototype[en]||(Element.prototype[en]=K=function(e,t){t=t||this.parentNode.querySelectorAll(e);for(var n=t.length,r=0;n>r;r++)if(t[r]===this)return!0;return!1}),function(){for(var t=0,n=["ms","moz","webkit","o"],r=0;r<n.length&&!e.requestAnimationFrame;++r)tn=e[n[r]+"RequestAnimationFrame"],nn=e[n[r]+"CancelAnimationFrame"]||e[n[r]+"CancelRequestAnimationFrame"];tn||(tn=function(n){var r=(new Date).getTime(),i=Math.max(0,16-(r-t)),s=e.setTimeout(function(){n(r+i)},i);return t=r+i,s}),nn||(nn=function(e){clearTimeout(e)})}(),"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=V),exports.interact=V):e.interact=V}(this),define("interact",["underscore"],function(e){return function(){var t,n;return t||e.interact}}(this)),define("apps/activities/listActivities/listActivities_view",["app","text!apps/activities/listActivities/templates/activity_item.html","text!apps/activities/listActivities/templates/activity_map.html","text!apps/activities/listActivities/templates/activity_tile.html","interact"],function(e,t,n,r,i){return e.module("ActivitiesApp.ListActivities.View",function(e,i,s,o,u,a){var f=72,l=60;e.Activity=o.ItemView.extend({className:"activity-wrapper btnActivityNoGap col-md4 col-xs-12 col-lg-1 js-edit drag-drop",template:a.template(t),events:{"click .js-move":"activityClickedDetected"},modelEvents:{"change:x":"xChanged","change:y":"yChanged","change:active":"aChanged"},xChanged:function(e,t){this.trigger("checkpoint:xChanged",t)},yChanged:function(e,t){this.trigger("checkpoint:xChanged",t)},aChanged:function(e,t){this.style.activate(this)},onRender:function(){this.style.arrange(this),this.style.activate(this)},onShow:function(){this.style.animate(this)},style:{arrange:function(e){var t=e.model.get("x"),n=e.model.get("y");u(e.$el).css({left:t*f,top:n*l})},activate:function(e){var t=e.model.get("active");t?(e.$el.find(".js-activate").text("Deactivate"),e.$el.find(".activity-emblem").css("opacity",1)):(e.$el.find(".activity-emblem").css("opacity",.5),e.$el.find(".js-activate").text("Activate"))},animate:function(e){var t=e.model.get("animate");t&&(e.$el.addClass("animated fadeInDown"),e.$el.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){e.$el.removeClass("animated fadeInDown")}))}},deleteActivityClicked:function(){this.trigger("activity:delete",this.model)},editActivityClicked:function(e){e.preventDefault(),this.trigger("activity:edit",this.model)},renameActivityClicked:function(e){this.trigger("activity:rename",this.model)},remove:function(){var e=this;o.ItemView.prototype.remove.call(this)},initialize:function(){this.model.on("change",this.render)},activityClickedDetected:function(e){e.preventDefault();var t=u(e.currentTarget).closest(".activity-wrapper");t.addClass("animated bounce infinite-animation"),this.trigger("element:show",this.model)}}),e.Activities=o.CompositeView.extend({className:"container-fluid activity-area activity-blue-glow padding-0px",template:a.template(n),itemView:e.Activity,itemViewContainer:"#adventure-view",triggers:{"click .js-new":"activity:new"},onRender:function(){console.log("####Activities are rendered")}}),e.ActivityTile=o.ItemView.extend({className:"activity-wrapper-tiles",template:a.template(r),triggers:{}}),e.ActivityTiles=o.CollectionView.extend({itemView:e.ActivityTile,onRender:function(){console.log("####Tiles Collections are rendered")}})}),e.ActivitiesApp.ListActivities.View}),define("entities/tile/tile_model",["jquery","underscore","backbone","app"],function(e,t,n,r){return Tile=n.Model.extend({idAttribute:"_id",parse:function(e){return this.set("_id",e._id),e},defaults:{x:"",y:"",a:!1},clear:function(){console.log("destroy"),this.destroy()}}),r.reqres.setHandler("tile:entity:new",function(e){return new Tile}),Tile}),define("entities/tile/tile_collection",["jquery","underscore","backbone","app","entities/tile/tile_model"],function(e,t,n,r,i){function a(){var e=new TileCollection;e.idLesson=o;var t=5,n=5,r=1,i=0,s=t*4+(t-1)*5;for(var u=0;u<s;u++)i%2===1?r>0?r%8===0?(f(r,i,"linkver",e),r=1,i+=1):(f(r,i,"linkver",e),r+=2):(console.log("Tiles-> x:"+r+" y: "+i),f(r,i,"linkver",e),r+=2):i%2===0&&(r%7===0?(f(r,i,"linkhor",e),r=0,i+=1):(f(r,i,"linkhor",e),r+=2));var a=5,l=5,c=0,h=0,p=a*l;for(var u=0;u<p;u++)c===0?(f(c,h,"dropzone",e),c+=2):c%8===0?(f(c,h,"dropzone",e),c=0,h+=2):(f(c,h,"dropzone",e),c+=2);return console.log(e),e}function f(e,t,n,r){var s="link",o=n;n==="dropzone"&&(s="dropzone",o="dropzone");var u=new i({tileTitle:s,x:e,y:t,tileType:o,activated:!1});r.add(u)}TileCollection=n.Collection.extend({model:i,url:function(){return"/adventures/edit/"+this.idLesson},parse:function(e){return e.tiles},initialize:function(e,t){this.idLesson=t}});var s=JSON.parse(e("#data-session").html()),o=s._id,u=function(){if(s.tiles===null||typeof s.tiles=="undefined")var e=a();else{var e=a();t.each(s.tiles,function(n){var r=e.where({x:n.x,y:n.y});t.each(r,function(e){e.set({a:!0})})})}return e},l={getTileEntities:function(t){var n={},r=new TileCollection(n,o),i=e.Deferred();return r.fetch({success:function(e){i.resolve(e)}}),i.promise()},getTileEntitiesFromHTML:function(){var e=u();return e}};return r.reqres.setHandler("tile:entities",function(){return l.getTileEntities()}),r.reqres.setHandler("tile:entities:initialized",function(){return l.getTileEntitiesFromHTML()}),TileCollection}),define("entities/lesson/lesson_model",["jquery","underscore","backbone","app","entities/tile/tile_collection"],function(e,t,n,r,i){Lesson=n.Model.extend({idAttribute:"_id",url:function(){return"/adventures/edit/"+o},model:{tiles:i},parse:function(e){this.set("_id",e._id);for(var t in this.model){var n=this.model[t],r=e[t];e[t]=new n(r)}return e},defaults:{lessonName:"",tiles:"",isLocked:!1,backgroundImageURL:""},initialize:function(e){if(e&&!(e.tiles instanceof n.Collection)){var t=this.model.tiles,r=e.tiles;e.tiles=new t(r),this.set("tiles",e.tiles)}},toggleSelected:function(){this.set({selected:!this.get("selected")})},clear:function(){console.log("destroy"),this.destroy()}});var s=JSON.parse(e("#data-session").html()),o=s.idSession,u=function(){var e=r.request("tile:entities:initialized");return e},a={getLessonEntity:function(t){var n=new Lesson({_id:t}),r=e.Deferred();return n.fetch({success:function(e){r.resolve(e),console.log("success")},error:function(e){r.resolve(undefined),console.log("fail")}}),r.promise()},getLessonEntityInitialized:function(){var e=new Lesson({_id:o});return e.set("lessonName",s.lessonName),e.set("backgroundImageURL",s.backgroundImageURL),e.set("tiles",u()),e}};return r.reqres.setHandler("lesson:entity",function(e){return a.getLessonEntity(e)}),r.reqres.setHandler("lesson:entity:initialized",function(){return a.getLessonEntityInitialized()}),r.reqres.setHandler("lesson:entity:new",function(e){return new Lesson}),Lesson}),define("apps/activities/listActivities/listActivities_controller",["app","apps/activities/listActivities/listActivities_view","interact","bootbox","bootstrap"],function(e,t,n,r){return e.module("ActivitiesApp.ListActivities",function(e,n,r,i,s,o){function a(e){o.each(e.models,function(e){typeof e.get("elements")!="undefined"&&o.each(e.get("elements").models,function(e){if(e.get("isImage")){var t=e.get("resourceUrl");window.imgPreloader.push(t)}})}),require(["entities/lesson/lesson_model"],function(){var r=n.request("lesson:entity:initialized");s.when(r).done(function(r){function f(e){var n=new t.ActivityTiles({collection:e});s("#adventure-view").prepend(s(n.render().el)),s(".activity-wrapper-dropzone").unwrap();var r=s(".activity-coordinate");o.each(r,function(e){var t=s(e).data(),n=t.x,r=t.y;s(e).parent().parent().css({left:n*u,top:r*a})})}var i=new t.Activities({collection:e,model:r});n.mainRegion.show(i);var u=72,a=60;f(r.get("tiles")),i.on("itemview:element:show",function(e){var t=e.model,r=t.get("activityType");switch(r){case"wordList":console.log("Clicked show  app -> %O",t),n.trigger("plugin:show:app",t);break;case"media":console.log("Clicked show media ->"),n.trigger("element:show",t)}})})})}var u=25;e.Controller={listActivities:function(e){e===undefined||e===null?require(["entities/activity/activity_collection"],function(){var e=n.request("activity:entities");s.when(e).done(function(e){a(e)})}):e.initialized?(console.log("options.initialized"),require(["entities/activity/activity_collection"],function(){var t=n.request("activity:entities:initialized");e.activityIDToBeAnimated&&t.get(e.activityIDToBeAnimated).set("animate",!0),a(t)})):e.activities&&a(e.activities)}}}),e.ActivitiesApp.ListActivities.Controller}),define("entities/pluginType/pluginType_model",["jquery","underscore","backbone","app"],function(e,t,n,r){var i=n.Model.extend({idAttribute:"_id",url:function(){return t.result(this.collection,"url")+(this.isNew()?"":this.id+"/")},parse:function(e){return this.set("_id",e._id),e},defaults:{title:"",category:"",plugins:""},initialize:function(e){},clear:function(){console.log("destroy"),this.destroy()}}),s={getPluginEntity:function(t){var n=new i({id:t}),r=e.Deferred();return n.fetch({success:function(e){r.resolve(e)},error:function(e){r.resolve(undefined)}}),r.promise()}};return r.reqres.setHandler("pluginType:entity",function(e){return s.getPluginEntity(e)}),r.reqres.setHandler("pluginType:entity:new",function(e){return new i}),i}),define("entities/plugin/plugin_model",["jquery","underscore","backbone","app"],function(e,t,n,r){var i=n.Model.extend({idAttribute:"_id",url:function(){return t.result(this.collection,"url")+(this.isNew()?"":this.id+"/")},parse:function(e){return this.set("_id",e._id),e},defaults:{pluginURL:"",pluginTeacherURL:"",pluginTitle:"",pluginServerPath:"",category:"",thumbnail:"",index:"",minLists:""},initialize:function(e){},clear:function(){console.log("destroy"),this.destroy()}}),s={getPluginEntity:function(t){var n=new i({id:t}),r=e.Deferred();return n.fetch({success:function(e){r.resolve(e)},error:function(e){r.resolve(undefined)}}),r.promise()}};return r.reqres.setHandler("plugin:entity",function(e){return s.getPluginEntity(e)}),r.reqres.setHandler("plugin:entity:new",function(e){return new i}),i}),define("entities/plugin/plugin_collection",["jquery","underscore","backbone","app","entities/plugin/plugin_model"],function(e,t,n,r,i){function f(e){t.each(e.models,function(e){var t=e.collection.indexOf(e)+1;e.set("index",t)},this)}PluginCollection=n.Collection.extend({model:i,url:function(){},parse:function(e){return e.plugins},initialize:function(e,t){this.idSession=t},selected:function(){return this.filter(function(e){return e.get("selected")})},remaining:function(){return this.without.apply(this,this.selected())}});var s=JSON.parse(e("#data-session").html()),o=s.idLesson,u=function(){var e=new PluginCollection(s.plugins,o);return f(e),e},a={getActivityEntities:function(t){var n={},r=new PluginCollection(n,o),i=e.Deferred();return r.fetch({success:function(e){i.resolve(e),f(r)}}),i.promise()},getPluginEntitiesFromHTML:function(){var e=u();return f(e),e},getPluginEntitiesInitialized:function(){var e=[{_id:"1",thumbnail:"fa-random",pluginTitle:"Randomizer",type:"",index:"",pluginURL:"/plugins/randomizer/randomizerTeacher.html"},{_id:"2",thumbnail:"fa-columns",pluginTitle:"Sort Me",type:"",index:"",pluginURL:"/plugins/sortMe/sortMeTeacher.html"},{_id:"3",thumbnail:"fa-bolt",pluginTitle:"Word Attack",type:"",index:"",pluginURL:"/plugins/wordAttack/wordAttackTeacher.html"},{_id:"4",thumbnail:"fa-dot-circle-o",pluginTitle:"Buzzer",type:"",index:"",pluginURL:"/plugins/buzzer/buzzerTeacher.html"},{_id:"5",thumbnail:"fa-circle-o",pluginTitle:"Word Wheel",type:"",index:"",pluginURL:"/plugins/wheelWord/wheelWordTeacher.html"},{_id:"6",thumbnail:"fa-bar-chart-o",pluginTitle:"Quick Poll",type:"",index:"",pluginURL:"/plugins/quickPoll/quickPollTeacher.html"},{_id:"7",thumbnail:"fa-pencil",pluginTitle:"Open Response",type:"",index:"",pluginURL:"/plugins/openResponse/openResponseTeacher.html"}],t=new PluginCollection(e);return f(t),t}};return r.reqres.setHandler("plugins:entities",function(){return a.getPluginEntities()}),r.reqres.setHandler("plugins:entities:initialized",function(){return a.getPluginEntitiesInitialized()}),PluginCollection}),define("entities/pluginType/pluginType_collection",["jquery","underscore","backbone","app","entities/pluginType/pluginType_model","entities/plugin/plugin_collection"],function(e,t,n,r,i,s){function l(e){t.each(e.models,function(e){var t=e.collection.indexOf(e)+1;e.set("index",t)},this)}PluginTypeCollection=n.Collection.extend({model:i,url:function(){return"/plugins/plugins.json"},parse:function(e){return e.pluginTypes},initialize:function(e,t){this.idSession=t},selected:function(){return this.filter(function(e){return e.get("selected")})},remaining:function(){return this.without.apply(this,this.selected())}});var o=JSON.parse(e("#data-session").html()),u=o.idSession,a=function(){var e=new PluginTypeCollection(o.pluginTypes,u);return l(e),e},f={getPluginTypesEntities:function(n){var r={},i=new PluginTypeCollection(r,u),o=e.Deferred();return i.fetch({success:function(e){t.each(e.models,function(e){var t=e.get("plugins"),n=new s(t);e.set("plugins",n)}),o.resolve(e),l(i)}}),o.promise()},getPluginEntitiesFromHTML:function(){var e=a();return l(e),e},getPluginTypesEntitiesInitialized:function(){var e=[{_id:"1",thumbnail:"fa-random",pluginTitle:"Randomizer",type:"",index:"",pluginURL:"/pluginTypes/randomizer/randomizerTeacher.html"},{_id:"2",thumbnail:"fa-columns",pluginTitle:"Sort Me",type:"",index:"",pluginURL:"/pluginTypes/sortMe/sortMeTeacher.html"},{_id:"3",thumbnail:"fa-bolt",pluginTitle:"Word Attack",type:"",index:"",pluginURL:"/pluginTypes/wordAttack/wordAttackTeacher.html"},{_id:"4",thumbnail:"fa-dot-circle-o",pluginTitle:"Buzzer",type:"",index:"",pluginURL:"/pluginTypes/buzzer/buzzerTeacher.html"},{_id:"5",thumbnail:"fa-circle-o",pluginTitle:"Word Wheel",type:"",index:"",pluginURL:"/pluginTypes/wheelWord/wheelWordTeacher.html"},{_id:"6",thumbnail:"fa-bar-chart-o",pluginTitle:"Quick Poll",type:"",index:"",pluginURL:"/pluginTypes/quickPoll/quickPollTeacher.html"},{_id:"7",thumbnail:"fa-pencil",pluginTitle:"Open Response",type:"",index:"",pluginURL:"/pluginTypes/openResponse/openResponseTeacher.html"},{_id:"8",thumbnail:"fa-search",pluginTitle:"Word Search",type:"",index:"",pluginURL:"/plugins/wordSearch/wordSearchTeacher.html"}],t=new PluginTypeCollection(e);return l(t),t}};return r.reqres.setHandler("pluginTypes:entities",function(){return f.getPluginTypesEntities()}),r.reqres.setHandler("pluginTypes:entities:initialized",function(){return f.getPluginTypesEntitiesInitialized()}),PluginTypeCollection}),define("apps/activities/activities_app",["app"],function(e){e.module("ActivitiesApp",function(e,t,n,r,i,s){e.onStart=function(){console.log("Starting ActivitiesApp")},e.onStop=function(){console.log("Stopping ActivitiesApp")}}),e.module("Router.ActivitiesApp",function(e,t,n,r,i,s){e.Router=r.AppRouter.extend({appRoutes:{"":"listActivitiesInitialized"}}),ActivitiesAPI={listActivities:function(e){require(["apps/activities/listActivities/listActivities_controller"],function(t){t.listActivities(e)})},listActivitiesInitialized:function(e){require(["apps/activities/listActivities/listActivities_controller"],function(n){t.getCurrentRoute()!=="activities"&&console.log("#########triggered list activities");if(e)e.initialized=!0,n.listActivities(e);else{var r={initialized:!0};n.listActivities(r)}})}},t.on("activities:listActivities",function(e){ActivitiesAPI.listActivities(e)}),t.on("activities:listActivities:initialized",function(e){console.log("activities:listActivities:initialized"),ActivitiesAPI.listActivitiesInitialized(e)}),t.addInitializer(function(){new e.Router({controller:ActivitiesAPI});var n;t.reqres.setHandler("plugins",function(e){return n}),require(["entities/pluginType/pluginType_collection"],function(){var e=t.request("pluginTypes:entities");i.when(e).done(function(e){n=e})})})})}),define("text!apps/plugins/show/templates/pluginsShow_template.html",[],function(){return'<iframe id="frameMiniApp" src="<%= url %>" frameborder="0"></iframe>\r\n<!--<button class="btn btn-default js-url">Show</button> \r\n<button class="btn btn-default js-back">Back</button>-->'}),define("text!apps/plugins/show/templates/pluginsShowMiniApp_template.html",[],function(){return'<a href="#" class="js-close plugin-close"><i class="fa fa-times fa-2x"></i></a>\r\n<iframe id="frameMiniApp" src="<%= url %>" frameborder="0"></iframe>\r\n<!--<button class="btn btn-default js-url">Show</button> \r\n<button class="btn btn-default js-back">Back</button>-->\r\n'}),define("apps/plugins/show/pluginsShow_view",["app","text!apps/plugins/show/templates/pluginsShow_template.html","text!apps/plugins/show/templates/pluginsShowMiniApp_template.html"],function(e,t,n){return e.module("PluginsApps.Show.View",function(e,r,i,s,o,u){e.Element=s.ItemView.extend({getTemplate:function(){return this.model.get("mode")==="internal"?(console.log("get Template external"),this.template=u.template(n)):(console.log("get Template internal"),this.template=u.template(t))},className:"container-fluid padding-0px plugin-area",events:{"click .js-url":"launchPlugin","click .js-close":"exitPlugin"},exitPlugin:function(e){e.preventDefault(),this.trigger("plugin:exit",this)},launchPlugin:function(){var e="about:blank",t="";this.trigger("plugin:show",e,t)}})}),e.PluginsApps.Show.View}),define("apps/plugins/show/pluginsShow_controller",["app","apps/plugins/show/pluginsShow_view"],function(e,t){return e.module("PluginsApps.Show",function(e,n,r,i,s,o){function u(e){var r=new t.Element({model:e});n.mainRegion.show(r),r.on("plugin:exit",function(e){console.log("plugin:exit"),e.model.get("mode")==="internal"?n.backToRoot():parent?n.trigger("plugins:list"):(console.log("plugin:back"),n.back())}),r.on("plugin:show",function(){var e={type:"UrlUpdate",options:"",resourceURL:url},t=new CustomEvent("Plugin",{detail:e});document.dispatchEvent(t)})}e.Controller={showPlugin:function(e,t){if(t.mode==="internal")var n=new r.Model({mode:"internal"});else if(t.mode==="external")var n=new r.Model({mode:"external",title:t.title});e?n.set("url",e):n.set("url","about:blank"),u(n)},showPluginByActivity:function(e){var t,i,s;t=n.request("plugins"),i=e.get("pluginApp"),console.log("plugins requested %O",t),console.log("app",e.get("pluginApp")),o.each(t.models,function(e){var t=e.get("plugins");s=t.findWhere({plugin:i}),console.log("pluginFound -> %O",s)});if(s!=="undefined"){var a={mode:"internal",title:s.get("pluginTitle"),activity:e},f=e.get("wordLists"),l="?isSingle=true&listID1="+f[0]+"&listID2="+f[1],c=new r.Model({mode:"internal",title:a.title});window.isDevelopment?c.set("url",s.get("pluginURL")+l):c.set("url",s.get("pluginURLDist")+l),u(c)}else console.log("app not found ->"+i)}}}),e.PluginsApps.Show.Controller}),define("apps/plugins/plugins_app",["app"],function(e){e.module("Router.PluginsApp",function(e,t,n,r,i,s){e.Router=r.AppRouter.extend({appRoutes:{"campfire-app":"backToRoot"}}),PluginsAPI={showPlugin:function(e,t){require(["apps/plugins/show/pluginsShow_controller"],function(n){n.showPlugin(e,t)})},showPluginById:function(e){require(["apps/plugins/show/pluginsShow_controller"],function(t){t.showPluginById(e)})},showPluginByActivity:function(e){require(["apps/plugins/show/pluginsShow_controller"],function(t){t.showPluginByActivity(e)})},backToRoot:function(e,n){t.backToRoot()}},t.on("plugin:show",function(e,t){var n={mode:"external"};PluginsAPI.showPlugin(e,n)}),t.on("plugin:show:app",function(e){PluginsAPI.showPluginByActivity(e)}),t.addInitializer(function(){new e.Router({controller:PluginsAPI}),jq(document).off("MiniApp"),jq(document).on("MiniApp",function(e,n){var r=n.detail;switch(r.type){case"UrlUpdate":var i=r.resourceURL;t.trigger("plugin:show",i,r.options);break;case"Exit":t.backToRoot(),console.log("back")}}),document.pluginListenerReady=!0,document.pluginHandlerCheck()})})}),define("text!apps/dialog/show/templates/dialog.html",[],function(){return'<div class="modal-dialog">\r\n    <div class="modal-content">\r\n      <div class="modal-header">\r\n        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>\r\n        <h4 class="modal-title" id="myModalLabel"><%= title %></h4>\r\n      </div>\r\n      <div class="modal-body">       \r\n        <div class="container-fluid" >\r\n          <iframe scrolling="yes" id="frameDialog" src="<%= resourceUrl %>" frameborder="0"></iframe>\r\n        </div>        \r\n      </div>\r\n    </div>\r\n  </div>'}),define("text!apps/dialog/show/templates/loadingDialog.html",[],function(){return'<div class="dialog-spin-area" style="color:white">\r\n  <i class="fa fa-spinner fa-3x fa-spin i-spinning-dialog"></i>  \r\n</div>'}),define("apps/dialog/show/dialogShow_view",["app","text!apps/dialog/show/templates/dialog.html","text!apps/dialog/show/templates/loadingDialog.html"],function(e,t,n){return e.module("DialogApp.Show.View",function(e,r,i,s,o,u){e.Dialog=s.ItemView.extend({template:u.template(t),className:"modal custom fade",id:"myModal",attributes:{tabindex:"-1",role:"dialog","aria-labelledby":"myModalLabel","aria-hidden":"true"},onShow:function(){console.log("dialogshow1"),o("#myModal").modal("show")}}),e.LoadingDialog=s.ItemView.extend({template:u.template(n),className:"modal custom fade",id:"myModal",attributes:{tabindex:"-1",role:"dialog","aria-labelledby":"myModalLabel","aria-hidden":"true"},onShow:function(){console.log("loadingDialogShow"),o("#myModal").modal({backdrop:"static",keyboard:!1})}})}),e.DialogApp.Show.View}),define("apps/dialog/show/dialogShow_controller",["app","apps/dialog/show/dialogShow_view","bootstrap","bootbox"],function(e,t){return e.module("DialogApp.Show",function(e,n,r,i,s,o){e.Controller={showDialog:function(e,i){var s=new r.Model({resourceUrl:e,title:i}),o=new t.Dialog({model:s});n.dialogRegion.show(o)},showLoadingDialog:function(){var e=new t.LoadingDialog;document.socketID||n.dialogRegion.show(e)}}}),e.DialogApp.Show.Controller}),define("apps/dialog/dialog_app",["app"],function(e){e.module("Router.ElementsApp",function(e,t,n,r,i,s){DialogAPI={showDialog:function(e,t){require(["apps/dialog/show/dialogShow_controller"],function(n){n.showDialog(e,t)})},showLoadingDialog:function(){require(["apps/dialog/show/dialogShow_controller"],function(e){e.showLoadingDialog()})}},t.on("dialog:show",function(e,t){DialogAPI.showDialog(e,t)}),t.on("dialog:show:loading",function(){DialogAPI.showLoadingDialog()})}),e.addInitializer(function(){jq(window.document).off("DialogUrl"),jq(window.document).on("DialogUrl",function(t,n){var r=n.detail;switch(r.type){case"UrlUpdate":var i=r.resourceURL;$(".modal-backdrop").remove(),e.trigger("dialog:show",i,r.title)}})})}),define("text!apps/responses/show/templates/responses_multiple.html",[],function(){return'<div class="row margin-0px ">\r\n  <div class="col-md-6 col-sm-6 col-xs-12 col-answer-a padding-0px  ">       \r\n    <div class="btn-answer-a col-md-12 col-sm-12 col-xs-12 answer-text js-answerA dullPink" id="answer-text-a">\r\n      <div class="col-md-1 col-sm-1 col-xs-1 label-a answer-text-label-area padding-0px">\r\n        <span class="answer-text-label">A</span>\r\n      </div>\r\n      <div class="col-md-11 col-sm-11 col-xs-11"><%= answerTextA %></div>            \r\n    </div>\r\n  </div>\r\n  <div class="col-md-6 col-sm-6 col-xs-12 col-answer-b padding-0px ">        \r\n    <div class="btn-answer-b col-md-12 col-sm-12 col-xs-12 answer-text js-answerB dullGreen " id="answer-text-b">\r\n      <div class="col-md-1 col-sm-1 col-xs-1  label-b answer-text-label-area padding-0px">\r\n        <span class="answer-text-label">B</span>\r\n      </div>\r\n      <div class="col-md-11 col-sm-11 col-xs-11"><%= answerTextB %></div>          \r\n    </div>\r\n  </div>\r\n</div>\r\n<div class="row margin-0px ">\r\n  <div class="col-md-6 col-sm-6 col-xs-12 col-answer-c padding-0px">        \r\n    <div class="btn-answer-c col-md-12 col-sm-12 col-xs-12 answer-text js-answerC dullBlue " id="answer-text-c">\r\n      <div class="col-md-1 col-sm-1 col-xs-1 answer-text-label-area label-c padding-0px">\r\n        <span class="answer-text-label">C</span>\r\n      </div>\r\n      <div class="col-md-11 col-sm-11 col-xs-11"><%= answerTextC %></div>           \r\n    </div>\r\n  </div>\r\n  <div class="col-md-6 col-sm-6 col-xs-12  col-answer-d padding-0px">       \r\n    <div class="btn-answer-d col-md-12 col-sm-12 col-xs-12 answer-text js-answerD dullYellow" id="answer-text-d">\r\n      <div class="col-md-1 col-sm-1 col-xs-1 answer-text-label-area label-d padding-0px">\r\n        <span class="answer-text-label">D</span>\r\n      </div>               \r\n      <div class="col-md-11 col-sm-11 col-xs-11"><%= answerTextD %></div> \r\n    </div>\r\n  </div>\r\n</div>\r\n<div class="row submit-area  margin-0px ">\r\n  <div class="col-sm-1 col-sm-offset-10  col-xs-3 col-xs-offset-8 col-md-1 col-md-offset-10 padding-0px" >\r\n    <a class="btn btn-lg btn-default js-submit-answer btn-submit">Submit</a>\r\n    <a class="btn btn-lg btn-default js-submit-next btn-submit-next">Next</a>\r\n  </div>    \r\n</div>\r\n\r\n'}),define("text!apps/responses/show/templates/responses_text.html",[],function(){return'<div class="student-text-response-desc camp-adventure-font">Answer:</div>\r\n<textarea class=\'student-text-response js-student-text-response\'></textarea>\r\n<div class="row submit-area  margin-0px ">\r\n  <div class="col-sm-1 col-sm-offset-10  col-xs-3 col-xs-offset-8 col-md-1 col-md-offset-10 padding-0px" >\r\n    <a class="btn btn-lg btn-default js-submit-answer btn-submit">Submit</a>\r\n    <a class="btn btn-lg btn-default js-submit-next btn-submit-next">Next</a>\r\n  </div>    \r\n</div>'}),define("apps/responses/show/responsesShow_view",["app","text!apps/responses/show/templates/responses_multiple.html","text!apps/responses/show/templates/responses_text.html"],function(e,t,n){return e.module("ResponsesApp.List.View",function(e,r,i,s,o,u){e.Response=s.ItemView.extend({className:"response-wrapper",getTemplate:function(){if(this.model.get("responseType")==="mul")return u.template(t);if(this.model.get("responseType")==="text")return u.template(n)},modelEvents:{"change:correct":"markAnswer"},triggers:{"click .js-correct":"answer:correct","click .js-wrong":"answer:wrong","click .js-submit-answer":"element:answer:submit","click .js-submit-next":"element:question:next"},events:{"click .js-answerA":"answerAClicked","click .js-answerB":"answerBClicked","click .js-answerC":"answerCClicked","click .js-answerD":"answerDClicked"},answerAClicked:function(e){this.trigger("element:answer:a",e.target,this.model),o("[class^=btn-answer]").removeClass("answer-selected"),o(".btn-answer-a").toggleClass("answer-selected")},answerBClicked:function(e){this.trigger("element:answer:b",e.target,this.model),o("[class^=btn-answer]").removeClass("answer-selected"),o(".btn-answer-b").toggleClass("answer-selected")},answerCClicked:function(e){this.trigger("element:answer:c",e.target,this.model),o("[class^=btn-answer]").removeClass("answer-selected"),o(".btn-answer-c").toggleClass("answer-selected")},answerDClicked:function(e){this.trigger("element:answer:d",e.target,this.model),o("[class^=btn-answer]").removeClass("answer-selected"),o(".btn-answer-d").toggleClass("answer-selected")},style:{mark:function(e){var t=e.model.get("correct");t===!0?(o(e.$el.find(".response-text")[0]).removeClass("answer-wrong"),o(e.$el.find(".response-text")[0]).addClass("answer-correct")):t===!1&&(o(e.$el.find(".response-text")[0]).removeClass("answer-correct"),o(e.$el.find(".response-text")[0]).addClass("answer-wrong"))}},markAnswer:function(){this.style.mark(this)},intialize:function(){}})}),e.ResponsesApp.List.View}),define("apps/responses/show/responsesShow_controller",["app","apps/responses/show/responsesShow_view","server/sync","grids"],function(e,t,n){return e.module("ResponsesApp.Show",function(e,n,r,i,s,o){function f(e){var r="",i=new t.Response({model:e}),o=n.request("element:answerArea"),u=n.request("activity"),f={checkAnswer:function(e,t){if(e===t){s("[id^=answer-text]").css("background-color","#e7e7e7"),f.removeBtnInteraction(),s("#answer-text-"+t).addClass("answer-correct"),s(".btn-submit").hide();var r=n.request("model"),i=r.collection.indexOf(r),o=i+1;return r.collection.at(o)&&s(".btn-submit-next").css("display","inline-block"),!0}return s("[id^=answer-text]").css("background-color","#e7e7e7"),console.log("answer incorrect"),f.removeBtnInteraction(),s("#answer-text-"+t).addClass("answer-correct"),s("#answer-text-"+e).addClass("answer-wrong"),console.log("answer is: "+t),s(".btn-submit").hide(),!1},removeBtnInteraction:function(){s("button").attr("class",function(e,t){return t.replace(/\bjs-answer\S+/g,"")}),s("button").attr("class",function(e,t){return t.replace(/\bbtn-answer-\S+/g,"")})},checkEmpty:function(e){return e===""?!0:!1}};a.listenTo(i,"show",function(){MathJax.Hub.Queue(["Typeset",MathJax.Hub]);if(e.get("responseType")==="mul"){var t=f.checkEmpty(e.get("answerTextA")),n=f.checkEmpty(e.get("answerTextB")),r=f.checkEmpty(e.get("answerTextC")),i=f.checkEmpty(e.get("answerTextD"));t&&s("#answer-text-a").hide(),n&&s("#answer-text-b").hide(),r&&s("#answer-text-c").hide(),i&&s("#answer-text-d").hide(),t&&n&&r&&i&&s(".answer-area").hide()}else e.get("responseType")===""&&s(".answer-area").hide();s(".answer-text").responsiveEqualHeightGrid();var o=e.get("studentAnswered");o&&f.checkAnswer(o,e.get("answer"))}),o.show(i),a.listenTo(i,"element:answer:a",function(e,t){r="a",console.log("Answer A triggered");var n=t;console.log(t.get("answer"))}),a.listenTo(i,"element:answer:b",function(){console.log("Answer B triggered"),r="b"}),a.listenTo(i,"element:answer:c",function(){console.log("Answer C triggered"),r="c"}),a.listenTo(i,"element:answer:d",function(){console.log("Answer D triggered"),r="d"}),a.listenTo(i,"element:answer:submit",function(e){var t=s("#floating-region");s(".js-student-text-response").addClass("disabled"),s(".js-student-text-response").attr("readonly","readonly"),t.addClass("black-overlay"),t.after("<div class='loader'>Submitting <i class='fa fa-spin fa-spinner'></i></div>"),setTimeout(function(){t.removeClass("black-overlay"),s(".loader").remove(),s(".js-student-text-response").removeClass("disabled"),s(".js-student-text-response").removeAttr("readonly")},1e3);if(e.view.$el.find(".js-student-text-response").length!==0){console.log("submit rextResposnse");var n=e.view.$el,i=n.find(".js-student-text-response");if(i.length>0){var o=s(i[0]).val();o=o.trim();if(typeof o!="undefined"){var a={activityID:u.id,elementID:e.model.id,answer:{answerSubmitted:o},meta:{}};window.pluginToServer("ACTIVITY","StudentTextAnswer",a)}console.log(o)}}else{var l=f.checkAnswer(r,e.model.get("answer"));console.log("Answer submmit: "+r);var a={activityID:u.id,elementID:e.model.id,correctAnswer:e.model.get("answer"),answer:{answerSubmitted:r,isCorrect:l,points:10},meta:{}};window.pluginToServer("ACTIVITY","StudentAnswer",a)}}),a.listenTo(i,"element:question:next",function(){n.execute("next")})}var u=i.Controller.extend({showResponses:function(e){f(e)}});e.Controller=new u;var a=e.Controller}),e.ResponsesApp.Show.Controller}),define("apps/responses/responses_app",["app"],function(e){e.module("Router.ResponsesApp",function(e,t,n,r,i,s){e.Router=r.AppRouter.extend({}),ResponsesAPI={showResponses:function(e){require(["apps/responses/show/responsesShow_controller"],function(t){t.showResponses(e)})}},t.on("responses:show",function(e){ResponsesAPI.showResponses(e)}),t.addInitializer(function(){new e.Router({controller:ResponsesAPI}),jq(document).off("Responses"),jq(document).on("Responses",function(e,t){var n=t.detail;switch(n.type){case"studentAnswer":var r=n.data}})})})}),define("app",["marionette","apps/config/marionette/region/dialog"],function(e,t){var n=new e.Application,r=0;return n.addRegions({headerRegion:"#header-region",mainRegion:"#main-region",dialogRegion:t}),n.navigate=function(e,t){t||(t={}),r+=1,console.log(r),Backbone.history.navigate(e,t)},n.getCurrentRoute=function(){return Backbone.history.fragment},n.back=function(){r>1?(window.history.back(),console.log("#########going back ")):(n.trigger("activities:listAdventures:initialized"),console.log("#########list Adventures ########"))},n.backToRoot=function(){n.trigger("activities:listActivities:initialized")},n.on("initialize:before",function(){document.socketID?console.log("####socket ready"):(n.trigger("dialog:show:loading"),console.log("####Initialized before activity"))}),n.on("initialize:after",function(){Backbone.history&&(require(["apps/elements/elements_app","apps/activities/activities_app","apps/plugins/plugins_app","apps/dialog/dialog_app","apps/responses/responses_app"],function(){Backbone.history.start(),n.getCurrentRoute()===""&&($(document).off("initializeApps"),$(document).on("initializeApps",function(e){var t=e.originalEvent.detail;switch(t.type){case"ListActivities":console.log("###list activities since no mini app"),n.trigger("activities:listAdventures:initialized")}}));var e=setTimeout(function(){$("#main-region").html().length===0,console.log("$('#main-region').html().length :"+$("#main-region").html().length)},5e3)}),console.log("Student Manager has started"))}),n}),requirejs.config({paths:{jquery:"//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min",underscore:"//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.6.0/underscore-min",backbone:"//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min",json2:"//cdnjs.cloudflare.com/ajax/libs/json2/20130526/json2.min",marionette:"//cdnjs.cloudflare.com/ajax/libs/backbone.marionette/1.8.0/backbone.marionette.min",text:"../../tools/libs/require/text",bootstrap:"//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.1.1/js/bootstrap.min",bootbox:"../../tools/libs/bootbox/bootbox.min",grids:"../../tools/libs/grids/grid_amd",interact:"../../tools/libs/interact/interact.min",tilesprocessor:"../../tools/misc/tilesProcessor",mathjax:"http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML&amp;delayStartupUntil=configured"},shim:{underscore:{exports:"_"},backbone:{deps:["underscore","jquery","json2"],exports:"Backbone"},marionette:{deps:["backbone"],exports:"Marionette"},bootstrap:["jquery"],bootbox:{deps:["bootstrap","jquery"],exports:"bootbox"},grids:["jquery"],interact:{deps:["underscore"],exports:"interact"},tilesprocessor:["underscore"],mathjax:{exports:"MathJax"}}}),require(["app"],function(e){e.start()}),define("require_main",function(){});